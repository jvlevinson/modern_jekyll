var e=(e=>(e.CONFIG_LOADED="config:loaded",e.CONFIG_CHANGE="config:change",e.CONFIG_DIRTY="config:dirty",e.CONFIG_SAVING="config:saving",e.CONFIG_SAVED="config:saved",e.CONFIG_RESET="config:reset",e.CONFIG_ERROR="config:error",e.COLOR_CHANGE="color:change",e.PALETTE_GENERATED="palette:generated",e.PREVIEW_UPDATE="preview:update",e.PREVIEW_RELOAD="preview:reload",e.REBUILD_STARTED="rebuild:started",e.REBUILD_STATUS="rebuild:status",e.REBUILD_COMPLETE="rebuild:complete",e.REBUILD_ERROR="rebuild:error",e.ACTIVE_COLOR_CHANGE="active-color:change",e.SECONDARY_COLOR_TOGGLE="secondary-color:toggle",e.COLOR_PRESET_SELECT="color-preset:select",e))(e||{});const t=new Map;function n(e,n){let o=t.get(e);o||(o=[],t.set(e,o));const r={handler:n,once:!1};return o.push(r),()=>a(e,n)}function a(e,n){const a=t.get(e);if(!a)return;const o=a.filter(e=>e.handler!==n);0===o.length?t.delete(e):t.set(e,o)}function o(e,n){const o=t.get(e);if(!o)return;const r=[...o];for(const t of r){try{t.handler(n)}catch(i){console.error(`Error in event handler for ${e}:`,i)}t.once&&a(e,t.handler)}}const r="onboard:draft:theme",i="onboard:active-tab";function l(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}let s=null,c=null,d=!1;const u="http://localhost:4001",h={GET_CONFIG:`${u}/api/config`,UPDATE_CONFIG:`${u}/api/config`,RESET_CONFIG:`${u}/api/config/reset`};async function p(){try{const t=await fetch(h.GET_CONFIG);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.json();if(!n.success||!n.theme)throw new Error("Invalid API response");c=n.theme;const a=function(e){if(!l())return null;try{const t=localStorage.getItem(e);if(!t)return null;const n=JSON.parse(t);return Date.now()>n.expires?(localStorage.removeItem(e),null):n.data}catch(t){return console.error("Failed to load draft:",t),null}}(r);return a?(s=a,d=!b(s,c),d&&(console.info("Restored unsaved theme changes from localStorage"),o(e.CONFIG_DIRTY,{isDirty:!0}))):(s=structuredClone(n.theme),d=!1),o(e.CONFIG_LOADED,{theme:s}),s}catch(t){return console.error("Failed to load config:",t),o(e.CONFIG_ERROR,{error:t,operation:"load"}),null}}function v(){return s?structuredClone(s):null}function g(e,t){return e===t||null!=e&&null!=t&&(typeof e==typeof t&&("object"==typeof e&&"object"==typeof t&&JSON.stringify(e)===JSON.stringify(t)))}function m(t,n){if(!s)return void console.warn("Cannot update config: not loaded");const a=s[t];s[t]=n;const i=c&&g(c[t],a),u=c&&g(c[t],n);d||!i||u?d&&!i&&u&&c&&(d=!b(s,c),d||o(e.CONFIG_DIRTY,{isDirty:!1})):(d=!0,o(e.CONFIG_DIRTY,{isDirty:!0})),function(e,t){if(l())try{const n={data:t,timestamp:Date.now(),expires:Date.now()+864e5};localStorage.setItem(e,JSON.stringify(n))}catch(n){console.error("Failed to save draft:",n)}else console.warn("localStorage not available")}(r,s),o(e.CONFIG_CHANGE,{key:t,value:n,previousValue:a,theme:structuredClone(s)})}async function f(){if(!s)return console.warn("Cannot save config: not loaded"),!1;if(!d)return console.info("No changes to save"),!0;try{o(e.CONFIG_SAVING,void 0);const t=await fetch(h.UPDATE_CONFIG,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({theme:s})});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.json();if(!n.success)throw new Error(n.error||"Failed to save configuration");return c=structuredClone(s),d=!1,function(e){if(l())try{localStorage.removeItem(e)}catch(t){console.error("Failed to clear draft:",t)}}(r),o(e.CONFIG_SAVED,{theme:s,message:"Theme configuration saved to _config.yml!"}),o(e.CONFIG_DIRTY,{isDirty:!1}),!0}catch(t){return console.error("Failed to save config:",t),o(e.CONFIG_ERROR,{error:t,operation:"save"}),!1}}function b(e,t){return JSON.stringify(e)===JSON.stringify(t)}const y=(e,t)=>{if("number"==typeof e)return 3===t?{mode:"rgb",r:(e>>8&15|e>>4&240)/255,g:(e>>4&15|240&e)/255,b:(15&e|e<<4&240)/255}:4===t?{mode:"rgb",r:(e>>12&15|e>>8&240)/255,g:(e>>8&15|e>>4&240)/255,b:(e>>4&15|240&e)/255,alpha:(15&e|e<<4&240)/255}:6===t?{mode:"rgb",r:(e>>16&255)/255,g:(e>>8&255)/255,b:(255&e)/255}:8===t?{mode:"rgb",r:(e>>24&255)/255,g:(e>>16&255)/255,b:(e>>8&255)/255,alpha:(255&e)/255}:void 0},_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},x=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,M="([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)",E=`${M}%`,S=`(?:${M}%|${M})`,w=`(?:${M}(deg|grad|rad|turn)|${M})`,$="\\s*,\\s*",k=new RegExp(`^rgba?\\(\\s*${M}${$}${M}${$}${M}\\s*(?:,\\s*${S}\\s*)?\\)$`),C=new RegExp(`^rgba?\\(\\s*${E}${$}${E}${$}${E}\\s*(?:,\\s*${S}\\s*)?\\)$`),L=(e="rgb")=>t=>void 0!==(t=((e,t)=>void 0===e?void 0:"object"!=typeof e?ae(e):void 0!==e.mode?e:t?{...e,mode:t}:void 0)(t,e))?t.mode===e?t:I[t.mode][e]?I[t.mode][e](t):"rgb"===e?I[t.mode].rgb(t):I.rgb[e](I[t.mode].rgb(t)):void 0,I={},z={},O=[],T={},A=e=>e,R=e=>(I[e.mode]={...I[e.mode],...e.toMode},Object.keys(e.fromMode||{}).forEach(t=>{I[t]||(I[t]={}),I[t][e.mode]=e.fromMode[t]}),e.ranges||(e.ranges={}),e.difference||(e.difference={}),e.channels.forEach(t=>{if(void 0===e.ranges[t]&&(e.ranges[t]=[0,1]),!e.interpolate[t])throw new Error(`Missing interpolator for: ${t}`);"function"==typeof e.interpolate[t]&&(e.interpolate[t]={use:e.interpolate[t]}),e.interpolate[t].fixup||(e.interpolate[t].fixup=A)}),z[e.mode]=e,(e.parse||[]).forEach(t=>{q(t,e.mode)}),L(e.mode)),q=(e,t)=>{if("string"==typeof e){if(!t)throw new Error("'mode' required when 'parser' is a string");T[e]=t}else"function"==typeof e&&O.indexOf(e)<0&&O.push(e)},N=/[^\x00-\x7F]|[a-zA-Z_]/,F=/[^\x00-\x7F]|[-\w]/,P="function",D="ident",G="number",H="percentage",j=")",U="none",B="hue",V="alpha";let Y=0;function W(e){let t=e[Y],n=e[Y+1];return"-"===t||"+"===t?/\d/.test(n)||"."===n&&/\d/.test(e[Y+2]):/\d/.test("."===t?n:t)}function J(e){if(Y>=e.length)return!1;let t=e[Y];if(N.test(t))return!0;if("-"===t){if(e.length-Y<2)return!1;let t=e[Y+1];return!("-"!==t&&!N.test(t))}return!1}const X={deg:1,rad:180/Math.PI,grad:.9,turn:360};function Z(e){let t="";if("-"!==e[Y]&&"+"!==e[Y]||(t+=e[Y++]),t+=K(e),"."===e[Y]&&/\d/.test(e[Y+1])&&(t+=e[Y++]+K(e)),"e"!==e[Y]&&"E"!==e[Y]||("-"!==e[Y+1]&&"+"!==e[Y+1]||!/\d/.test(e[Y+2])?/\d/.test(e[Y+1])&&(t+=e[Y++]+K(e)):t+=e[Y++]+e[Y++]+K(e)),J(e)){let n=Q(e);return"deg"===n||"rad"===n||"turn"===n||"grad"===n?{type:B,value:t*X[n]}:void 0}return"%"===e[Y]?(Y++,{type:H,value:+t}):{type:G,value:+t}}function K(e){let t="";for(;/\d/.test(e[Y]);)t+=e[Y++];return t}function Q(e){let t="";for(;Y<e.length&&F.test(e[Y]);)t+=e[Y++];return t}function ee(e){let t=Q(e);return"("===e[Y]?(Y++,{type:P,value:t}):"none"===t?{type:U,value:void 0}:{type:D,value:t}}function te(e){e._i=0;let t=e[e._i++];if(!t||t.type!==P||"color"!==t.value)return;if(t=e[e._i++],t.type!==D)return;const n=T[t.value];if(!n)return;const a={mode:n},o=ne(e,!1);if(!o)return;const r=(e=>z[e])(n).channels;for(let i,l,s=0;s<r.length;s++)i=o[s],l=r[s],i.type!==U&&(a[l]=i.type===G?i.value:i.value/100,"alpha"===l&&(a[l]=Math.max(0,Math.min(1,a[l]))));return a}function ne(e,t){const n=[];let a;for(;e._i<e.length;)if(a=e[e._i++],a.type===U||a.type===G||a.type===V||a.type===H||t&&a.type===B)n.push(a);else{if(a.type!==j)return;if(e._i<e.length)return}if(!(n.length<3||n.length>4)){if(4===n.length){if(n[3].type!==V)return;n[3]=n[3].value}return 3===n.length&&n.push({type:U,value:void 0}),n.every(e=>e.type!==V)?n:void 0}}const ae=e=>{if("string"!=typeof e)return;const t=function(e=""){let t,n=e.trim(),a=[];for(Y=0;Y<n.length;)if(t=n[Y++],"\n"!==t&&"\t"!==t&&" "!==t){if(","===t)return;if(")"!==t){if("+"===t){if(Y--,W(n)){a.push(Z(n));continue}return}if("-"===t){if(Y--,W(n)){a.push(Z(n));continue}if(J(n)){a.push({type:D,value:Q(n)});continue}return}if("."===t){if(Y--,W(n)){a.push(Z(n));continue}return}if("/"===t){for(;Y<n.length&&("\n"===n[Y]||"\t"===n[Y]||" "===n[Y]);)Y++;let e;if(W(n)&&(e=Z(n),e.type!==B)){a.push({type:V,value:e});continue}if(J(n)&&"none"===Q(n)){a.push({type:V,value:{type:U,value:void 0}});continue}return}if(/\d/.test(t))Y--,a.push(Z(n));else{if(!N.test(t))return;Y--,a.push(ee(n))}}else a.push({type:j})}else for(;Y<n.length&&("\n"===n[Y]||"\t"===n[Y]||" "===n[Y]);)Y++;return a}(e),n=t?function(e,t){e._i=0;let n=e[e._i++];if(!n||n.type!==P)return;let a=ne(e,t);return a?(a.unshift(n.value),a):void 0}(t,!0):void 0;let a,o=0,r=O.length;for(;o<r;)if(void 0!==(a=O[o++](e,n)))return a;return t?te(t):void 0};const oe=(re=(e,t,n)=>e+n*(t-e),e=>{let t=(e=>{let t=[];for(let n=0;n<e.length-1;n++){let a=e[n],o=e[n+1];void 0===a&&void 0===o?t.push(void 0):void 0!==a&&void 0!==o?t.push([a,o]):t.push(void 0!==a?[a,a]:[o,o])}return t})(e);return e=>{let n=e*t.length,a=e>=1?t.length-1:Math.max(Math.floor(n),0),o=t[a];return void 0===o?void 0:re(o[0],o[1],n-a)}});var re;const ie=e=>{let t=!1,n=e.map(e=>void 0!==e?(t=!0,e):1);return t?n:e},le={mode:"rgb",channels:["r","g","b","alpha"],parse:[function(e,t){if(!t||"rgb"!==t[0]&&"rgba"!==t[0])return;const n={mode:"rgb"},[,a,o,r,i]=t;return a.type!==B&&o.type!==B&&r.type!==B?(a.type!==U&&(n.r=a.type===G?a.value/255:a.value/100),o.type!==U&&(n.g=o.type===G?o.value/255:o.value/100),r.type!==U&&(n.b=r.type===G?r.value/255:r.value/100),i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n):void 0},e=>{let t;return(t=e.match(x))?y(parseInt(t[1],16),t[1].length):void 0},e=>{let t,n={mode:"rgb"};if(t=e.match(k))void 0!==t[1]&&(n.r=t[1]/255),void 0!==t[2]&&(n.g=t[2]/255),void 0!==t[3]&&(n.b=t[3]/255);else{if(!(t=e.match(C)))return;void 0!==t[1]&&(n.r=t[1]/100),void 0!==t[2]&&(n.g=t[2]/100),void 0!==t[3]&&(n.b=t[3]/100)}return void 0!==t[4]?n.alpha=Math.max(0,Math.min(1,t[4]/100)):void 0!==t[5]&&(n.alpha=Math.max(0,Math.min(1,+t[5]))),n},e=>y(_[e.toLowerCase()],6),e=>"transparent"===e?{mode:"rgb",r:0,g:0,b:0,alpha:0}:void 0,"srgb"],serialize:"srgb",interpolate:{r:oe,g:oe,b:oe,alpha:{use:oe,fixup:ie}},gamut:!0,white:{r:1,g:1,b:1},black:{r:0,g:0,b:0}},se=(e=0)=>Math.pow(Math.abs(e),563/256)*Math.sign(e),ce=e=>{let t=se(e.r),n=se(e.g),a=se(e.b),o={mode:"xyz65",x:.5766690429101305*t+.1855582379065463*n+.1882286462349947*a,y:.297344975250536*t+.6273635662554661*n+.0752914584939979*a,z:.0270313613864123*t+.0706888525358272*n+.9913375368376386*a};return void 0!==e.alpha&&(o.alpha=e.alpha),o},de=e=>Math.pow(Math.abs(e),256/563)*Math.sign(e),ue=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o={mode:"a98",r:de(2.0415879038107465*e-.5650069742788597*t-.3447313507783297*n),g:de(-.9692436362808798*e+1.8759675015077206*t+.0415550574071756*n),b:de(.0134442806320312*e-.1183623922310184*t+1.0151749943912058*n)};return void 0!==a&&(o.alpha=a),o},he=(e=0)=>{const t=Math.abs(e);return t<=.04045?e/12.92:(Math.sign(e)||1)*Math.pow((t+.055)/1.055,2.4)},pe=({r:e,g:t,b:n,alpha:a})=>{let o={mode:"lrgb",r:he(e),g:he(t),b:he(n)};return void 0!==a&&(o.alpha=a),o},ve=e=>{let{r:t,g:n,b:a,alpha:o}=pe(e),r={mode:"xyz65",x:.4123907992659593*t+.357584339383878*n+.1804807884018343*a,y:.2126390058715102*t+.715168678767756*n+.0721923153607337*a,z:.0193308187155918*t+.119194779794626*n+.9505321522496607*a};return void 0!==o&&(r.alpha=o),r},ge=(e=0)=>{const t=Math.abs(e);return t>.0031308?(Math.sign(e)||1)*(1.055*Math.pow(t,1/2.4)-.055):12.92*e},me=({r:e,g:t,b:n,alpha:a},o="rgb")=>{let r={mode:o,r:ge(e),g:ge(t),b:ge(n)};return void 0!==a&&(r.alpha=a),r},fe=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=me({r:3.2409699419045226*e-1.537383177570094*t-.4986107602930034*n,g:-.9692436362808796*e+1.8759675015077204*t+.0415550574071756*n,b:.0556300796969936*e-.2039769588889765*t+1.0569715142428784*n});return void 0!==a&&(o.alpha=a),o},be={...le,mode:"a98",parse:["a98-rgb"],serialize:"a98-rgb",fromMode:{rgb:e=>ue(ve(e)),xyz65:ue},toMode:{rgb:e=>fe(ce(e)),xyz65:ce}},ye=e=>(e%=360)<0?e+360:e,_e=e=>{return n=e=>Math.abs(e)<=180?e:e-360*Math.sign(e),(t=e).map((e,a,o)=>{if(void 0===e)return e;let r=ye(e);return 0===a||void 0===t[a-1]?r:n(r-ye(o[a-1]))}).reduce((e,t)=>e.length&&void 0!==t&&void 0!==e[e.length-1]?(e.push(t+e[e.length-1]),e):(e.push(t),e),[]);var t,n},xe=[-.14861,1.78277,-.29227,-.90649,1.97294,0],Me=Math.PI/180,Ee=180/Math.PI;let Se=xe[3]*xe[4],we=xe[1]*xe[4],$e=xe[1]*xe[2]-xe[0]*xe[3];const ke=(e,t)=>{if(void 0===e.h||void 0===t.h||!e.s||!t.s)return 0;let n=ye(e.h),a=ye(t.h),o=Math.sin((a-n+360)/2*Math.PI/180);return 2*Math.sqrt(e.s*t.s)*o},Ce=(e,t)=>{if(void 0===e.h||void 0===t.h||!e.c||!t.c)return 0;let n=ye(e.h),a=ye(t.h),o=Math.sin((a-n+360)/2*Math.PI/180);return 2*Math.sqrt(e.c*t.c)*o},Le=e=>{let t=e.reduce((e,t)=>{if(void 0!==t){let n=t*Math.PI/180;e.sin+=Math.sin(n),e.cos+=Math.cos(n)}return e},{sin:0,cos:0}),n=180*Math.atan2(t.sin,t.cos)/Math.PI;return n<0?360+n:n},Ie={mode:"cubehelix",channels:["h","s","l","alpha"],parse:["--cubehelix"],serialize:"--cubehelix",ranges:{h:[0,360],s:[0,4.614],l:[0,1]},fromMode:{rgb:({r:e,g:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=($e*n+e*Se-t*we)/($e+Se-we),r=n-o,i=(xe[4]*(t-o)-xe[2]*r)/xe[3],l={mode:"cubehelix",l:o,s:0===o||1===o?void 0:Math.sqrt(r*r+i*i)/(xe[4]*o*(1-o))};return l.s&&(l.h=Math.atan2(i,r)*Ee-120),void 0!==a&&(l.alpha=a),l}},toMode:{rgb:({h:e,s:t,l:n,alpha:a})=>{let o={mode:"rgb"};e=(void 0===e?0:e+120)*Me,void 0===n&&(n=0);let r=void 0===t?0:t*n*(1-n),i=Math.cos(e),l=Math.sin(e);return o.r=n+r*(xe[0]*i+xe[1]*l),o.g=n+r*(xe[2]*i+xe[3]*l),o.b=n+r*(xe[4]*i+xe[5]*l),void 0!==a&&(o.alpha=a),o}},interpolate:{h:{use:oe,fixup:_e},s:oe,l:oe,alpha:{use:oe,fixup:ie}},difference:{h:ke},average:{h:Le}},ze=({l:e,a:t,b:n,alpha:a},o="lch")=>{void 0===t&&(t=0),void 0===n&&(n=0);let r=Math.sqrt(t*t+n*n),i={mode:o,l:e,c:r};return r&&(i.h=ye(180*Math.atan2(n,t)/Math.PI)),void 0!==a&&(i.alpha=a),i},Oe=({l:e,c:t,h:n,alpha:a},o="lab")=>{void 0===n&&(n=0);let r={mode:o,l:e,a:t?t*Math.cos(n/180*Math.PI):0,b:t?t*Math.sin(n/180*Math.PI):0};return void 0!==a&&(r.alpha=a),r},Te=Math.pow(29,3)/Math.pow(3,3),Ae=Math.pow(6,3)/Math.pow(29,3),Re=.3457/.3585,qe=1,Ne=.2958/.3585,Fe=.3127/.329,Pe=1,De=.3583/.329;let Ge=e=>Math.pow(e,3)>Ae?Math.pow(e,3):(116*e-16)/Te;const He=({l:e,a:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=(e+16)/116,r=o-n/200,i={mode:"xyz65",x:Ge(t/500+o)*Fe,y:Ge(o)*Pe,z:Ge(r)*De};return void 0!==a&&(i.alpha=a),i},je=e=>fe(He(e)),Ue=e=>e>Ae?Math.cbrt(e):(Te*e+16)/116,Be=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Ue(e/Fe),r=Ue(t/Pe),i={mode:"lab65",l:116*r-16,a:500*(o-r),b:200*(r-Ue(n/De))};return void 0!==a&&(i.alpha=a),i},Ve=e=>{let t=Be(ve(e));return e.r===e.b&&e.b===e.g&&(t.a=t.b=0),t},Ye=26/180*Math.PI,We=Math.cos(Ye),Je=Math.sin(Ye),Xe=100/Math.log(1.39),Ze=({l:e,c:t,h:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o={mode:"lab65",l:(Math.exp(1*e/Xe)-1)/.0039},r=(Math.exp(.0435*t*1*1)-1)/.075,i=r*Math.cos(n/180*Math.PI-Ye),l=r*Math.sin(n/180*Math.PI-Ye);return o.a=i*We-l/.83*Je,o.b=i*Je+l/.83*We,void 0!==a&&(o.alpha=a),o},Ke=({l:e,a:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=t*We+n*Je,r=.83*(n*We-t*Je),i=Math.sqrt(o*o+r*r),l={mode:"dlch",l:Xe/1*Math.log(1+.0039*e),c:Math.log(1+.075*i)/.0435};return l.c&&(l.h=ye((Math.atan2(r,o)+Ye)/Math.PI*180)),void 0!==a&&(l.alpha=a),l},Qe=e=>Ze(ze(e,"dlch")),et=e=>Oe(Ke(e),"dlab"),tt={mode:"dlab",parse:["--din99o-lab"],serialize:"--din99o-lab",toMode:{lab65:Qe,rgb:e=>je(Qe(e))},fromMode:{lab65:et,rgb:e=>et(Ve(e))},channels:["l","a","b","alpha"],ranges:{l:[0,100],a:[-40.09,45.501],b:[-40.469,44.344]},interpolate:{l:oe,a:oe,b:oe,alpha:{use:oe,fixup:ie}}},nt={mode:"dlch",parse:["--din99o-lch"],serialize:"--din99o-lch",toMode:{lab65:Ze,dlab:e=>Oe(e,"dlab"),rgb:e=>je(Ze(e))},fromMode:{lab65:Ke,dlab:e=>ze(e,"dlch"),rgb:e=>Ke(Ve(e))},channels:["l","c","h","alpha"],ranges:{l:[0,100],c:[0,51.484],h:[0,360]},interpolate:{l:oe,c:oe,h:{use:oe,fixup:_e},alpha:{use:oe,fixup:ie}},difference:{h:Ce},average:{h:Le}};const at={mode:"hsi",toMode:{rgb:function({h:e,s:t,i:n,alpha:a}){e=ye(void 0!==e?e:0),void 0===t&&(t=0),void 0===n&&(n=0);let o,r=Math.abs(e/60%2-1);switch(Math.floor(e/60)){case 0:o={r:n*(1+t*(3/(2-r)-1)),g:n*(1+t*(3*(1-r)/(2-r)-1)),b:n*(1-t)};break;case 1:o={r:n*(1+t*(3*(1-r)/(2-r)-1)),g:n*(1+t*(3/(2-r)-1)),b:n*(1-t)};break;case 2:o={r:n*(1-t),g:n*(1+t*(3/(2-r)-1)),b:n*(1+t*(3*(1-r)/(2-r)-1))};break;case 3:o={r:n*(1-t),g:n*(1+t*(3*(1-r)/(2-r)-1)),b:n*(1+t*(3/(2-r)-1))};break;case 4:o={r:n*(1+t*(3*(1-r)/(2-r)-1)),g:n*(1-t),b:n*(1+t*(3/(2-r)-1))};break;case 5:o={r:n*(1+t*(3/(2-r)-1)),g:n*(1-t),b:n*(1+t*(3*(1-r)/(2-r)-1))};break;default:o={r:n*(1-t),g:n*(1-t),b:n*(1-t)}}return o.mode="rgb",void 0!==a&&(o.alpha=a),o}},parse:["--hsi"],serialize:"--hsi",fromMode:{rgb:function({r:e,g:t,b:n,alpha:a}){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.max(e,t,n),r=Math.min(e,t,n),i={mode:"hsi",s:e+t+n===0?0:1-3*r/(e+t+n),i:(e+t+n)/3};return o-r!==0&&(i.h=60*(o===e?(t-n)/(o-r)+6*(t<n):o===t?(n-e)/(o-r)+2:(e-t)/(o-r)+4)),void 0!==a&&(i.alpha=a),i}},channels:["h","s","i","alpha"],ranges:{h:[0,360]},gamut:"rgb",interpolate:{h:{use:oe,fixup:_e},s:oe,i:oe,alpha:{use:oe,fixup:ie}},difference:{h:ke},average:{h:Le}};const ot=new RegExp(`^hsla?\\(\\s*${w}${$}${E}${$}${E}\\s*(?:,\\s*${S}\\s*)?\\)$`);const rt={mode:"hsl",toMode:{rgb:function({h:e,s:t,l:n,alpha:a}){e=ye(void 0!==e?e:0),void 0===t&&(t=0),void 0===n&&(n=0);let o,r=n+t*(n<.5?n:1-n),i=r-2*(r-n)*Math.abs(e/60%2-1);switch(Math.floor(e/60)){case 0:o={r:r,g:i,b:2*n-r};break;case 1:o={r:i,g:r,b:2*n-r};break;case 2:o={r:2*n-r,g:r,b:i};break;case 3:o={r:2*n-r,g:i,b:r};break;case 4:o={r:i,g:2*n-r,b:r};break;case 5:o={r:r,g:2*n-r,b:i};break;default:o={r:2*n-r,g:2*n-r,b:2*n-r}}return o.mode="rgb",void 0!==a&&(o.alpha=a),o}},fromMode:{rgb:function({r:e,g:t,b:n,alpha:a}){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.max(e,t,n),r=Math.min(e,t,n),i={mode:"hsl",s:o===r?0:(o-r)/(1-Math.abs(o+r-1)),l:.5*(o+r)};return o-r!==0&&(i.h=60*(o===e?(t-n)/(o-r)+6*(t<n):o===t?(n-e)/(o-r)+2:(e-t)/(o-r)+4)),void 0!==a&&(i.alpha=a),i}},channels:["h","s","l","alpha"],ranges:{h:[0,360]},gamut:"rgb",parse:[function(e,t){if(!t||"hsl"!==t[0]&&"hsla"!==t[0])return;const n={mode:"hsl"},[,a,o,r,i]=t;if(a.type!==U){if(a.type===H)return;n.h=a.value}if(o.type!==U){if(o.type===B)return;n.s=o.value/100}if(r.type!==U){if(r.type===B)return;n.l=r.value/100}return i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n},e=>{let t=e.match(ot);if(!t)return;let n={mode:"hsl"};return void 0!==t[3]?n.h=+t[3]:void 0!==t[1]&&void 0!==t[2]&&(n.h=((e,t)=>{switch(t){case"deg":return+e;case"rad":return e/Math.PI*180;case"grad":return e/10*9;case"turn":return 360*e}})(t[1],t[2])),void 0!==t[4]&&(n.s=Math.min(Math.max(0,t[4]/100),1)),void 0!==t[5]&&(n.l=Math.min(Math.max(0,t[5]/100),1)),void 0!==t[6]?n.alpha=Math.max(0,Math.min(1,t[6]/100)):void 0!==t[7]&&(n.alpha=Math.max(0,Math.min(1,+t[7]))),n}],serialize:e=>`hsl(${void 0!==e.h?e.h:"none"} ${void 0!==e.s?100*e.s+"%":"none"} ${void 0!==e.l?100*e.l+"%":"none"}${e.alpha<1?` / ${e.alpha}`:""})`,interpolate:{h:{use:oe,fixup:_e},s:oe,l:oe,alpha:{use:oe,fixup:ie}},difference:{h:ke},average:{h:Le}};function it({h:e,s:t,v:n,alpha:a}){e=ye(void 0!==e?e:0),void 0===t&&(t=0),void 0===n&&(n=0);let o,r=Math.abs(e/60%2-1);switch(Math.floor(e/60)){case 0:o={r:n,g:n*(1-t*r),b:n*(1-t)};break;case 1:o={r:n*(1-t*r),g:n,b:n*(1-t)};break;case 2:o={r:n*(1-t),g:n,b:n*(1-t*r)};break;case 3:o={r:n*(1-t),g:n*(1-t*r),b:n};break;case 4:o={r:n*(1-t*r),g:n*(1-t),b:n};break;case 5:o={r:n,g:n*(1-t),b:n*(1-t*r)};break;default:o={r:n*(1-t),g:n*(1-t),b:n*(1-t)}}return o.mode="rgb",void 0!==a&&(o.alpha=a),o}function lt({r:e,g:t,b:n,alpha:a}){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.max(e,t,n),r=Math.min(e,t,n),i={mode:"hsv",s:0===o?0:1-r/o,v:o};return o-r!==0&&(i.h=60*(o===e?(t-n)/(o-r)+6*(t<n):o===t?(n-e)/(o-r)+2:(e-t)/(o-r)+4)),void 0!==a&&(i.alpha=a),i}const st={mode:"hsv",toMode:{rgb:it},parse:["--hsv"],serialize:"--hsv",fromMode:{rgb:lt},channels:["h","s","v","alpha"],ranges:{h:[0,360]},gamut:"rgb",interpolate:{h:{use:oe,fixup:_e},s:oe,v:oe,alpha:{use:oe,fixup:ie}},difference:{h:ke},average:{h:Le}};const ct={mode:"hwb",toMode:{rgb:function({h:e,w:t,b:n,alpha:a}){if(void 0===t&&(t=0),void 0===n&&(n=0),t+n>1){let e=t+n;t/=e,n/=e}return it({h:e,s:1===n?1:1-t/(1-n),v:1-n,alpha:a})}},fromMode:{rgb:function(e){let t=lt(e);if(void 0===t)return;let n=void 0!==t.s?t.s:0,a=void 0!==t.v?t.v:0,o={mode:"hwb",w:(1-n)*a,b:1-a};return void 0!==t.h&&(o.h=t.h),void 0!==t.alpha&&(o.alpha=t.alpha),o}},channels:["h","w","b","alpha"],ranges:{h:[0,360]},gamut:"rgb",parse:[function(e,t){if(!t||"hwb"!==t[0])return;const n={mode:"hwb"},[,a,o,r,i]=t;if(a.type!==U){if(a.type===H)return;n.h=a.value}if(o.type!==U){if(o.type===B)return;n.w=o.value/100}if(r.type!==U){if(r.type===B)return;n.b=r.value/100}return i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n}],serialize:e=>`hwb(${void 0!==e.h?e.h:"none"} ${void 0!==e.w?100*e.w+"%":"none"} ${void 0!==e.b?100*e.b+"%":"none"}${e.alpha<1?` / ${e.alpha}`:""})`,interpolate:{h:{use:oe,fixup:_e},w:oe,b:oe,alpha:{use:oe,fixup:ie}},difference:{h:(e,t)=>{if(void 0===e.h||void 0===t.h)return 0;let n=ye(e.h),a=ye(t.h);return Math.abs(a-n)>180?n-(a-360*Math.sign(a-n)):a-n}},average:{h:Le}},dt=.1593017578125,ut=78.84375,ht=.8359375,pt=18.8515625,vt=18.6875;function gt(e){if(e<0)return 0;const t=Math.pow(e,1/ut);return 1e4*Math.pow(Math.max(0,t-ht)/(pt-vt*t),1/dt)}function mt(e){if(e<0)return 0;const t=Math.pow(e/1e4,dt);return Math.pow((ht+pt*t)/(1+vt*t),ut)}const ft=e=>Math.max(e/203,0),bt=({i:e,t:t,p:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);const o=gt(e+.008609037037932761*t+.11102962500302593*n),r=gt(e-.00860903703793275*t-.11102962500302599*n),i=gt(e+.5600313357106791*t-.32062717498731885*n),l={mode:"xyz65",x:ft(2.070152218389422*o-1.3263473389671556*r+.2066510476294051*i),y:ft(.3647385209748074*o+.680566024947227*r-.0453045459220346*i),z:ft(-.049747207535812*o-.0492609666966138*r+1.1880659249923042*i)};return void 0!==a&&(l.alpha=a),l},yt=(e=0)=>Math.max(203*e,0),_t=({x:e,y:t,z:n,alpha:a})=>{const o=yt(e),r=yt(t),i=yt(n),l=mt(.3592832590121217*o+.6976051147779502*r-.0358915932320289*i),s=mt(-.1920808463704995*o+1.1004767970374323*r+.0753748658519118*i),c=mt(.0070797844607477*o+.0748396662186366*r+.8433265453898765*i),d={mode:"itp",i:.5*l+.5*s,t:1.61376953125*l-3.323486328125*s+1.709716796875*c,p:4.378173828125*l-4.24560546875*s-.132568359375*c};return void 0!==a&&(d.alpha=a),d},xt={mode:"itp",channels:["i","t","p","alpha"],parse:["--ictcp"],serialize:"--ictcp",toMode:{xyz65:bt,rgb:e=>fe(bt(e))},fromMode:{xyz65:_t,rgb:e=>_t(ve(e))},ranges:{i:[0,.581],t:[-.369,.272],p:[-.164,.331]},interpolate:{i:oe,t:oe,p:oe,alpha:{use:oe,fixup:ie}}},Mt=e=>{if(e<0)return 0;let t=Math.pow(e/1e4,dt);return Math.pow((ht+pt*t)/(1+vt*t),134.03437499999998)},Et=(e=0)=>Math.max(203*e,0),St=({x:e,y:t,z:n,alpha:a})=>{e=Et(e),t=Et(t);let o=1.15*e-.15*(n=Et(n)),r=.66*t+.34*e,i=Mt(.41478972*o+.579999*r+.014648*n),l=Mt(-.20151*o+1.120649*r+.0531008*n),s=Mt(-.0166008*o+.2648*r+.6684799*n),c=(i+l)/2,d={mode:"jab",j:.44*c/(1-.56*c)-16295499532821565e-27,a:3.524*i-4.066708*l+.542708*s,b:.199076*i+1.096799*l-1.295875*s};return void 0!==a&&(d.alpha=a),d},wt=16295499532821565e-27,$t=e=>{if(e<0)return 0;let t=Math.pow(e,.007460772656268216);return 1e4*Math.pow((ht-t)/(vt*t-pt),1/dt)},kt=e=>e/203,Ct=({j:e,a:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=(e+wt)/(.44+.56*(e+wt)),r=$t(o+.13860504*t+.058047316*n),i=$t(o-.13860504*t-.058047316*n),l=$t(o-.096019242*t-.8118919*n),s={mode:"xyz65",x:kt(1.661373024652174*r-.914523081304348*i+.23136208173913045*l),y:kt(-.3250758611844533*r+1.571847026732543*i-.21825383453227928*l),z:kt(-.090982811*r-.31272829*i+1.5227666*l)};return void 0!==a&&(s.alpha=a),s},Lt=e=>{let t=St(ve(e));return e.r===e.b&&e.b===e.g&&(t.a=t.b=0),t},It=e=>fe(Ct(e)),zt={mode:"jab",channels:["j","a","b","alpha"],parse:["--jzazbz"],serialize:"--jzazbz",fromMode:{rgb:Lt,xyz65:St},toMode:{rgb:It,xyz65:Ct},ranges:{j:[0,.222],a:[-.109,.129],b:[-.185,.134]},interpolate:{j:oe,a:oe,b:oe,alpha:{use:oe,fixup:ie}}},Ot=({j:e,a:t,b:n,alpha:a})=>{void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.sqrt(t*t+n*n),r={mode:"jch",j:e,c:o};return o&&(r.h=ye(180*Math.atan2(n,t)/Math.PI)),void 0!==a&&(r.alpha=a),r},Tt=({j:e,c:t,h:n,alpha:a})=>{void 0===n&&(n=0);let o={mode:"jab",j:e,a:t?t*Math.cos(n/180*Math.PI):0,b:t?t*Math.sin(n/180*Math.PI):0};return void 0!==a&&(o.alpha=a),o},At={mode:"jch",parse:["--jzczhz"],serialize:"--jzczhz",toMode:{jab:Tt,rgb:e=>It(Tt(e))},fromMode:{rgb:e=>Ot(Lt(e)),jab:Ot},channels:["j","c","h","alpha"],ranges:{j:[0,.221],c:[0,.19],h:[0,360]},interpolate:{h:{use:oe,fixup:_e},c:oe,j:oe,alpha:{use:oe,fixup:ie}},difference:{h:Ce},average:{h:Le}},Rt=Math.pow(29,3)/Math.pow(3,3),qt=Math.pow(6,3)/Math.pow(29,3);let Nt=e=>Math.pow(e,3)>qt?Math.pow(e,3):(116*e-16)/Rt;const Ft=({l:e,a:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=(e+16)/116,r=o-n/200,i={mode:"xyz50",x:Nt(t/500+o)*Re,y:Nt(o)*qe,z:Nt(r)*Ne};return void 0!==a&&(i.alpha=a),i},Pt=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=me({r:3.1341359569958707*e-1.6173863321612538*t-.4906619460083532*n,g:-.978795502912089*e+1.916254567259524*t+.03344273116131949*n,b:.07195537988411677*e-.2289768264158322*t+1.405386058324125*n});return void 0!==a&&(o.alpha=a),o},Dt=e=>Pt(Ft(e)),Gt=e=>{let{r:t,g:n,b:a,alpha:o}=pe(e),r={mode:"xyz50",x:.436065742824811*t+.3851514688337912*n+.14307845442264197*a,y:.22249319175623702*t+.7168870538238823*n+.06061979053616537*a,z:.013923904500943465*t+.09708128566574634*n+.7140993584005155*a};return void 0!==o&&(r.alpha=o),r},Ht=e=>e>qt?Math.cbrt(e):(Rt*e+16)/116,jt=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Ht(e/Re),r=Ht(t/qe),i={mode:"lab",l:116*r-16,a:500*(o-r),b:200*(r-Ht(n/Ne))};return void 0!==a&&(i.alpha=a),i},Ut=e=>{let t=jt(Gt(e));return e.r===e.b&&e.b===e.g&&(t.a=t.b=0),t};const Bt={mode:"lab",toMode:{xyz50:Ft,rgb:Dt},fromMode:{xyz50:jt,rgb:Ut},channels:["l","a","b","alpha"],ranges:{l:[0,100],a:[-125,125],b:[-125,125]},parse:[function(e,t){if(!t||"lab"!==t[0])return;const n={mode:"lab"},[,a,o,r,i]=t;return a.type!==B&&o.type!==B&&r.type!==B?(a.type!==U&&(n.l=Math.min(Math.max(0,a.value),100)),o.type!==U&&(n.a=o.type===G?o.value:125*o.value/100),r.type!==U&&(n.b=r.type===G?r.value:125*r.value/100),i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n):void 0}],serialize:e=>`lab(${void 0!==e.l?e.l:"none"} ${void 0!==e.a?e.a:"none"} ${void 0!==e.b?e.b:"none"}${e.alpha<1?` / ${e.alpha}`:""})`,interpolate:{l:oe,a:oe,b:oe,alpha:{use:oe,fixup:ie}}},Vt={...Bt,mode:"lab65",parse:["--lab-d65"],serialize:"--lab-d65",toMode:{xyz65:He,rgb:je},fromMode:{xyz65:Be,rgb:Ve},ranges:{l:[0,100],a:[-125,125],b:[-125,125]}};const Yt={mode:"lch",toMode:{lab:Oe,rgb:e=>Dt(Oe(e))},fromMode:{rgb:e=>ze(Ut(e)),lab:ze},channels:["l","c","h","alpha"],ranges:{l:[0,100],c:[0,150],h:[0,360]},parse:[function(e,t){if(!t||"lch"!==t[0])return;const n={mode:"lch"},[,a,o,r,i]=t;if(a.type!==U){if(a.type===B)return;n.l=Math.min(Math.max(0,a.value),100)}if(o.type!==U&&(n.c=Math.max(0,o.type===G?o.value:150*o.value/100)),r.type!==U){if(r.type===H)return;n.h=r.value}return i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n}],serialize:e=>`lch(${void 0!==e.l?e.l:"none"} ${void 0!==e.c?e.c:"none"} ${void 0!==e.h?e.h:"none"}${e.alpha<1?` / ${e.alpha}`:""})`,interpolate:{h:{use:oe,fixup:_e},c:oe,l:oe,alpha:{use:oe,fixup:ie}},difference:{h:Ce},average:{h:Le}},Wt={...Yt,mode:"lch65",parse:["--lch-d65"],serialize:"--lch-d65",toMode:{lab65:e=>Oe(e,"lab65"),rgb:e=>je(Oe(e,"lab65"))},fromMode:{rgb:e=>ze(Ve(e),"lch65"),lab65:e=>ze(e,"lch65")},ranges:{l:[0,100],c:[0,150],h:[0,360]}},Jt=({l:e,u:t,v:n,alpha:a})=>{void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.sqrt(t*t+n*n),r={mode:"lchuv",l:e,c:o};return o&&(r.h=ye(180*Math.atan2(n,t)/Math.PI)),void 0!==a&&(r.alpha=a),r},Xt=({l:e,c:t,h:n,alpha:a})=>{void 0===n&&(n=0);let o={mode:"luv",l:e,u:t?t*Math.cos(n/180*Math.PI):0,v:t?t*Math.sin(n/180*Math.PI):0};return void 0!==a&&(o.alpha=a),o},Zt=(e,t,n)=>4*e/(e+15*t+3*n),Kt=(e,t,n)=>9*t/(e+15*t+3*n),Qt=Zt(Re,qe,Ne),en=Kt(Re,qe,Ne),tn=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=(r=t/qe)<=qt?Rt*r:116*Math.cbrt(r)-16;var r;let i=Zt(e,t,n),l=Kt(e,t,n);isFinite(i)&&isFinite(l)?(i=13*o*(i-Qt),l=13*o*(l-en)):o=i=l=0;let s={mode:"luv",l:o,u:i,v:l};return void 0!==a&&(s.alpha=a),s},nn=4*(an=Re)/(an+15*qe+3*Ne);var an;const on=((e,t,n)=>9*t/(e+15*t+3*n))(Re,qe,Ne),rn=({l:e,u:t,v:n,alpha:a})=>{if(void 0===e&&(e=0),0===e)return{mode:"xyz50",x:0,y:0,z:0};void 0===t&&(t=0),void 0===n&&(n=0);let o=t/(13*e)+nn,r=n/(13*e)+on,i=qe*(e<=8?e/Rt:Math.pow((e+16)/116,3)),l={mode:"xyz50",x:i*(9*o)/(4*r),y:i,z:i*(12-3*o-20*r)/(4*r)};return void 0!==a&&(l.alpha=a),l},ln={mode:"lchuv",toMode:{luv:Xt,rgb:e=>Pt(rn(Xt(e)))},fromMode:{rgb:e=>Jt(tn(Gt(e))),luv:Jt},channels:["l","c","h","alpha"],parse:["--lchuv"],serialize:"--lchuv",ranges:{l:[0,100],c:[0,176.956],h:[0,360]},interpolate:{h:{use:oe,fixup:_e},c:oe,l:oe,alpha:{use:oe,fixup:ie}},difference:{h:Ce},average:{h:Le}},sn={...le,mode:"lrgb",toMode:{rgb:me},fromMode:{rgb:pe},parse:["srgb-linear"],serialize:"srgb-linear"},cn={mode:"luv",toMode:{xyz50:rn,rgb:e=>Pt(rn(e))},fromMode:{xyz50:tn,rgb:e=>tn(Gt(e))},channels:["l","u","v","alpha"],parse:["--luv"],serialize:"--luv",ranges:{l:[0,100],u:[-84.936,175.042],v:[-125.882,87.243]},interpolate:{l:oe,u:oe,v:oe,alpha:{use:oe,fixup:ie}}},dn=({r:e,g:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.cbrt(.412221469470763*e+.5363325372617348*t+.0514459932675022*n),r=Math.cbrt(.2119034958178252*e+.6806995506452344*t+.1073969535369406*n),i=Math.cbrt(.0883024591900564*e+.2817188391361215*t+.6299787016738222*n),l={mode:"oklab",l:.210454268309314*o+.7936177747023054*r-.0040720430116193*i,a:1.9779985324311684*o-2.42859224204858*r+.450593709617411*i,b:.0259040424655478*o+.7827717124575296*r-.8086757549230774*i};return void 0!==a&&(l.alpha=a),l},un=e=>{let t=dn(pe(e));return e.r===e.b&&e.b===e.g&&(t.a=t.b=0),t},hn=({l:e,a:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=Math.pow(e+.3963377773761749*t+.2158037573099136*n,3),r=Math.pow(e-.1055613458156586*t-.0638541728258133*n,3),i=Math.pow(e-.0894841775298119*t-1.2914855480194092*n,3),l={mode:"lrgb",r:4.076741636075957*o-3.3077115392580616*r+.2309699031821044*i,g:-1.2684379732850317*o+2.6097573492876887*r-.3413193760026573*i,b:-.0041960761386756*o-.7034186179359362*r+1.7076146940746117*i};return void 0!==a&&(l.alpha=a),l},pn=e=>me(hn(e));function vn(e){const t=.206,n=1.206/1.03;return.5*(n*e-t+Math.sqrt((n*e-t)*(n*e-t)+.12*n*e))}function gn(e){return(e*e+.206*e)/(1.206/1.03*(e+.03))}function mn(e,t){let n=function(e,t){let n,a,o,r,i,l,s,c;-1.88170328*e-.80936493*t>1?(n=1.19086277,a=1.76576728,o=.59662641,r=.75515197,i=.56771245,l=4.0767416621,s=-3.3077115913,c=.2309699292):1.81444104*e-1.19445276*t>1?(n=.73956515,a=-.45954404,o=.08285427,r=.1254107,i=.14503204,l=-1.2684380046,s=2.6097574011,c=-.3413193965):(n=1.35733652,a=-.00915799,o=-1.1513021,r=-.50559606,i=.00692167,l=-.0041960863,s=-.7034186147,c=1.707614701);let d=n+a*e+o*t+r*e*e+i*e*t,u=.3963377774*e+.2158037573*t,h=-.1055613458*e-.0638541728*t,p=-.0894841775*e-1.291485548*t;{let e=1+d*u,t=1+d*h,n=1+d*p,a=l*(e*e*e)+s*(t*t*t)+c*(n*n*n),o=l*(3*u*e*e)+s*(3*h*t*t)+c*(3*p*n*n);d-=a*o/(o*o-.5*a*(l*(6*u*u*e)+s*(6*h*h*t)+c*(6*p*p*n)))}return d}(e,t),a=hn({l:1,a:n*e,b:n*t}),o=Math.cbrt(1/Math.max(a.r,a.g,a.b));return[o,o*n]}function fn(e,t,n=null){n||(n=mn(e,t));let a=n[0],o=n[1];return[o/a,o/(1-a)]}function bn(e,t,n){let a=mn(t,n),o=function(e,t,n,a,o,r=null){let i;if(r||(r=mn(e,t)),(n-o)*r[1]-(r[0]-o)*a<=0)i=r[1]*o/(a*r[0]+r[1]*(o-n));else{i=r[1]*(o-1)/(a*(r[0]-1)+r[1]*(o-n));{let r=n-o,l=.3963377774*e+.2158037573*t,s=-.1055613458*e-.0638541728*t,c=-.0894841775*e-1.291485548*t,d=r+a*l,u=r+a*s,h=r+a*c;{let e=o*(1-i)+i*n,t=i*a,r=e+t*l,p=e+t*s,v=e+t*c,g=r*r*r,m=p*p*p,f=v*v*v,b=3*d*r*r,y=3*u*p*p,_=3*h*v*v,x=6*d*d*r,M=6*u*u*p,E=6*h*h*v,S=4.0767416621*g-3.3077115913*m+.2309699292*f-1,w=4.0767416621*b-3.3077115913*y+.2309699292*_,$=w/(w*w-.5*S*(4.0767416621*x-3.3077115913*M+.2309699292*E)),k=-S*$,C=-1.2684380046*g+2.6097574011*m-.3413193965*f-1,L=-1.2684380046*b+2.6097574011*y-.3413193965*_,I=L/(L*L-.5*C*(-1.2684380046*x+2.6097574011*M-.3413193965*E)),z=-C*I,O=-.0041960863*g-.7034186147*m+1.707614701*f-1,T=-.0041960863*b-.7034186147*y+1.707614701*_,A=T/(T*T-.5*O*(-.0041960863*x-.7034186147*M+1.707614701*E)),R=-O*A;k=$>=0?k:1e6,z=I>=0?z:1e6,R=A>=0?R:1e6,i+=Math.min(k,Math.min(z,R))}}}return i}(t,n,e,1,e,a),r=fn(t,n,a),i=e*(.11516993+1/(7.4477897+4.1590124*n+t*(1.75198401*n-2.19557347+t*(-2.13704948-10.02301043*n+t*(5.38770819*n-4.24894561+4.69891013*t))))),l=(1-e)*(.11239642+1/(1.6132032-.68124379*n+t*(.40370612+.90148123*n+t*(.6122399*n-.27087943+t*(.00299215-.45399568*n-.14661872*t))))),s=.9*(o/Math.min(e*r[0],(1-e)*r[1]))*Math.sqrt(Math.sqrt(1/(1/(i*i*i*i)+1/(l*l*l*l))));return i=.4*e,l=.8*(1-e),[Math.sqrt(1/(1/(i*i)+1/(l*l))),s,o]}function yn(e){const t=void 0!==e.l?e.l:0,n=void 0!==e.a?e.a:0,a=void 0!==e.b?e.b:0,o={mode:"okhsl",l:vn(t)};void 0!==e.alpha&&(o.alpha=e.alpha);let r=Math.sqrt(n*n+a*a);if(!r)return o.s=0,o;let i,[l,s,c]=bn(t,n/r,a/r);if(r<s){let e=0,t=.8*l;i=.8*((r-e)/(t+(1-t/s)*(r-e)))}else{let e=.2*s*s*1.25*1.25/l;i=.8+.2*((r-s)/(e+(1-e/(c-s))*(r-s)))}return i&&(o.s=i,o.h=ye(180*Math.atan2(a,n)/Math.PI)),o}function _n(e){let t=void 0!==e.h?e.h:0,n=void 0!==e.s?e.s:0,a=void 0!==e.l?e.l:0;const o={mode:"oklab",l:gn(a)};if(void 0!==e.alpha&&(o.alpha=e.alpha),!n||1===a)return o.a=o.b=0,o;let r,i,l,s,c=Math.cos(t/180*Math.PI),d=Math.sin(t/180*Math.PI),[u,h,p]=bn(o.l,c,d);n<.8?(r=1.25*n,i=0,l=.8*u,s=1-l/h):(r=5*(n-.8),i=h,l=.2*h*h*1.25*1.25/u,s=1-l/(p-h));let v=i+r*l/(1-s*r);return o.a=v*c,o.b=v*d,o}const xn={...rt,mode:"okhsl",channels:["h","s","l","alpha"],parse:["--okhsl"],serialize:"--okhsl",fromMode:{oklab:yn,rgb:e=>yn(un(e))},toMode:{oklab:_n,rgb:e=>pn(_n(e))}};function Mn(e){let t=void 0!==e.l?e.l:0,n=void 0!==e.a?e.a:0,a=void 0!==e.b?e.b:0,o=Math.sqrt(n*n+a*a),r=o?n/o:1,i=o?a/o:1,[l,s]=fn(r,i),c=1-.5/l,d=s/(o+t*s),u=d*t,h=d*o,p=gn(u),v=h*p/u,g=hn({l:p,a:r*v,b:i*v}),m=Math.cbrt(1/Math.max(g.r,g.g,g.b,0));t/=m,o=o/m*vn(t)/t,t=vn(t);const f={mode:"okhsv",s:o?(.5+s)*h/(.5*s+s*c*h):0,v:t?t/u:0};return f.s&&(f.h=ye(180*Math.atan2(a,n)/Math.PI)),void 0!==e.alpha&&(f.alpha=e.alpha),f}function En(e){const t={mode:"oklab"};void 0!==e.alpha&&(t.alpha=e.alpha);const n=void 0!==e.h?e.h:0,a=void 0!==e.s?e.s:0,o=void 0!==e.v?e.v:0,r=Math.cos(n/180*Math.PI),i=Math.sin(n/180*Math.PI),[l,s]=fn(r,i),c=.5,d=1-c/l,u=1-a*c/(c+s-s*d*a),h=a*s*c/(c+s-s*d*a),p=gn(u),v=h*p/u,g=hn({l:p,a:r*v,b:i*v}),m=Math.cbrt(1/Math.max(g.r,g.g,g.b,0)),f=gn(o*u),b=h*f/u;return t.l=f*m,t.a=b*r*m,t.b=b*i*m,t}const Sn={...st,mode:"okhsv",channels:["h","s","v","alpha"],parse:["--okhsv"],serialize:"--okhsv",fromMode:{oklab:Mn,rgb:e=>Mn(un(e))},toMode:{oklab:En,rgb:e=>pn(En(e))}};const wn={...Bt,mode:"oklab",toMode:{lrgb:hn,rgb:pn},fromMode:{lrgb:dn,rgb:un},ranges:{l:[0,1],a:[-.4,.4],b:[-.4,.4]},parse:[function(e,t){if(!t||"oklab"!==t[0])return;const n={mode:"oklab"},[,a,o,r,i]=t;return a.type!==B&&o.type!==B&&r.type!==B?(a.type!==U&&(n.l=Math.min(Math.max(0,a.type===G?a.value:a.value/100),1)),o.type!==U&&(n.a=o.type===G?o.value:.4*o.value/100),r.type!==U&&(n.b=r.type===G?r.value:.4*r.value/100),i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n):void 0}],serialize:e=>`oklab(${void 0!==e.l?e.l:"none"} ${void 0!==e.a?e.a:"none"} ${void 0!==e.b?e.b:"none"}${e.alpha<1?` / ${e.alpha}`:""})`};const $n={...Yt,mode:"oklch",toMode:{oklab:e=>Oe(e,"oklab"),rgb:e=>pn(Oe(e,"oklab"))},fromMode:{rgb:e=>ze(un(e),"oklch"),oklab:e=>ze(e,"oklch")},parse:[function(e,t){if(!t||"oklch"!==t[0])return;const n={mode:"oklch"},[,a,o,r,i]=t;if(a.type!==U){if(a.type===B)return;n.l=Math.min(Math.max(0,a.type===G?a.value:a.value/100),1)}if(o.type!==U&&(n.c=Math.max(0,o.type===G?o.value:.4*o.value/100)),r.type!==U){if(r.type===H)return;n.h=r.value}return i.type!==U&&(n.alpha=Math.min(1,Math.max(0,i.type===G?i.value:i.value/100))),n}],serialize:e=>`oklch(${void 0!==e.l?e.l:"none"} ${void 0!==e.c?e.c:"none"} ${void 0!==e.h?e.h:"none"}${e.alpha<1?` / ${e.alpha}`:""})`,ranges:{l:[0,1],c:[0,.4],h:[0,360]}},kn=e=>{let{r:t,g:n,b:a,alpha:o}=pe(e),r={mode:"xyz65",x:.486570948648216*t+.265667693169093*n+.1982172852343625*a,y:.2289745640697487*t+.6917385218365062*n+.079286914093745*a,z:0*t+.0451133818589026*n+1.043944368900976*a};return void 0!==o&&(r.alpha=o),r},Cn=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o=me({r:2.4934969119414263*e-.9313836179191242*t-.402710784450717*n,g:-.8294889695615749*e+1.7626640603183465*t+.0236246858419436*n,b:.0358458302437845*e-.0761723892680418*t+.9568845240076871*n},"p3");return void 0!==a&&(o.alpha=a),o},Ln={...le,mode:"p3",parse:["display-p3"],serialize:"display-p3",fromMode:{rgb:e=>Cn(ve(e)),xyz65:Cn},toMode:{rgb:e=>fe(kn(e)),xyz65:kn}},In=e=>{let t=Math.abs(e);return t>=1/512?Math.sign(e)*Math.pow(t,1/1.8):16*e},zn=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o={mode:"prophoto",r:In(1.3457868816471585*e-.2555720873797946*t-.0511018649755453*n),g:In(-.5446307051249019*e+1.5082477428451466*t+.0205274474364214*n),b:In(0*e+0*t+1.2119675456389452*n)};return void 0!==a&&(o.alpha=a),o},On=(e=0)=>{let t=Math.abs(e);return t>=16/512?Math.sign(e)*Math.pow(t,1.8):e/16},Tn=e=>{let t=On(e.r),n=On(e.g),a=On(e.b),o={mode:"xyz50",x:.7977666449006423*t+.1351812974005331*n+.0313477341283922*a,y:.2880748288194013*t+.7118352342418731*n+899369387256e-16*a,z:0*t+0*n+.8251046025104602*a};return void 0!==e.alpha&&(o.alpha=e.alpha),o},An={...le,mode:"prophoto",parse:["prophoto-rgb"],serialize:"prophoto-rgb",fromMode:{xyz50:zn,rgb:e=>zn(Gt(e))},toMode:{xyz50:Tn,rgb:e=>Pt(Tn(e))}},Rn=1.09929682680944,qn=e=>{const t=Math.abs(e);return t>.018053968510807?(Math.sign(e)||1)*(Rn*Math.pow(t,.45)-(Rn-1)):4.5*e},Nn=({x:e,y:t,z:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);let o={mode:"rec2020",r:qn(1.7166511879712683*e-.3556707837763925*t-.2533662813736599*n),g:qn(-.6666843518324893*e+1.6164812366349395*t+.0157685458139111*n),b:qn(.0176398574453108*e-.0427706132578085*t+.9421031212354739*n)};return void 0!==a&&(o.alpha=a),o},Fn=1.09929682680944,Pn=(e=0)=>{let t=Math.abs(e);return t<.08124285829863151?e/4.5:(Math.sign(e)||1)*Math.pow((t+Fn-1)/Fn,1/.45)},Dn=e=>{let t=Pn(e.r),n=Pn(e.g),a=Pn(e.b),o={mode:"xyz65",x:.6369580483012911*t+.1446169035862083*n+.1688809751641721*a,y:.262700212011267*t+.6779980715188708*n+.059301716469862*a,z:0*t+.0280726930490874*n+1.0609850577107909*a};return void 0!==e.alpha&&(o.alpha=e.alpha),o},Gn={...le,mode:"rec2020",fromMode:{xyz65:Nn,rgb:e=>Nn(ve(e))},toMode:{xyz65:Dn,rgb:e=>fe(Dn(e))},parse:["rec2020"],serialize:"rec2020"},Hn=.0037930732552754493,jn=Math.cbrt(Hn),Un=e=>Math.cbrt(e)-jn,Bn=e=>Math.pow(e+jn,3),Vn={mode:"xyb",channels:["x","y","b","alpha"],parse:["--xyb"],serialize:"--xyb",toMode:{rgb:({x:e,y:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);const o=Bn(e+t)-Hn,r=Bn(t-e)-Hn,i=Bn(n+t)-Hn,l=me({r:11.031566904639861*o-9.866943908131562*r-.16462299650829934*i,g:-3.2541473810744237*o+4.418770377582723*r-.16462299650829934*i,b:-3.6588512867136815*o+2.7129230459360922*r+1.9459282407775895*i});return void 0!==a&&(l.alpha=a),l}},fromMode:{rgb:e=>{const{r:t,g:n,b:a,alpha:o}=pe(e),r=Un(.3*t+.622*n+.078*a+Hn),i=Un(.23*t+.692*n+.078*a+Hn),l={mode:"xyb",x:(r-i)/2,y:(r+i)/2,b:Un(.2434226892454782*t+.2047674442449682*n+.5518098665095535*a+Hn)-(r+i)/2};return void 0!==o&&(l.alpha=o),l}},ranges:{x:[-.0154,.0281],y:[0,.8453],b:[-.2778,.388]},interpolate:{x:oe,y:oe,b:oe,alpha:{use:oe,fixup:ie}}},Yn={mode:"xyz50",parse:["xyz-d50"],serialize:"xyz-d50",toMode:{rgb:Pt,lab:jt},fromMode:{rgb:Gt,lab:Ft},channels:["x","y","z","alpha"],ranges:{x:[0,.964],y:[0,.999],z:[0,.825]},interpolate:{x:oe,y:oe,z:oe,alpha:{use:oe,fixup:ie}}},Wn={mode:"xyz65",toMode:{rgb:fe,xyz50:e=>{let{x:t,y:n,z:a,alpha:o}=e;void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0);let r={mode:"xyz50",x:1.0479298208405488*t+.0229467933410191*n-.0501922295431356*a,y:.0296278156881593*t+.990434484573249*n-.0170738250293851*a,z:-.0092430581525912*t+.0150551448965779*n+.7518742899580008*a};return void 0!==o&&(r.alpha=o),r}},fromMode:{rgb:ve,xyz50:e=>{let{x:t,y:n,z:a,alpha:o}=e;void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0);let r={mode:"xyz65",x:.9554734527042182*t-.0230985368742614*n+.0632593086610217*a,y:-.0283697069632081*t+1.0099954580058226*n+.021041398966943*a,z:.0123140016883199*t-.0205076964334779*n+1.3303659366080753*a};return void 0!==o&&(r.alpha=o),r}},ranges:{x:[0,.95],y:[0,1],z:[0,1.088]},channels:["x","y","z","alpha"],parse:["xyz","xyz-d65"],serialize:"xyz-d65",interpolate:{x:oe,y:oe,z:oe,alpha:{use:oe,fixup:ie}}},Jn={mode:"yiq",toMode:{rgb:({y:e,i:t,q:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);const o={mode:"rgb",r:e+.95608445*t+.6208885*n,g:e-.27137664*t-.6486059*n,b:e-1.10561724*t+1.70250126*n};return void 0!==a&&(o.alpha=a),o}},fromMode:{rgb:({r:e,g:t,b:n,alpha:a})=>{void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);const o={mode:"yiq",y:.29889531*e+.58662247*t+.11448223*n,i:.59597799*e-.2741761*t-.32180189*n,q:.21147017*e-.52261711*t+.31114694*n};return void 0!==a&&(o.alpha=a),o}},channels:["y","i","q","alpha"],parse:["--yiq"],serialize:"--yiq",ranges:{i:[-.595,.595],q:[-.522,.522]},interpolate:{y:oe,i:oe,q:oe,alpha:{use:oe,fixup:ie}}},Xn=e=>Math.round(255*(e=>Math.max(0,Math.min(1,e||0)))(e)),Zn=L("rgb"),Kn=e=>(e=>{if(void 0===e)return;return"#"+(1<<24|Xn(e.r)<<16|Xn(e.g)<<8|Xn(e.b)).toString(16).slice(1)})(Zn(e));R(be),R(Ie),R(tt),R(nt),R(at),R(rt),R(st),R(ct),R(xt),R(zt),R(At),R(Bt),R(Vt),R(Yt),R(Wt),R(ln),R(sn),R(cn),R(xn),R(Sn),R(wn),R($n),R(Ln),R(An),R(Gn),R(le),R(Vn),R(Yn),R(Wn),R(Jn);const Qn=L("rgb");function ea(e){return`oklch(${e.l}% ${e.c} ${e.h}deg)`}function ta(e){return{l:Math.max(0,Math.min(100,e.l)),c:Math.max(0,Math.min(.4,e.c)),h:(e.h%360+360)%360}}function na(e){if("undefined"!=typeof CSS&&CSS.supports&&CSS.supports("color","oklch(50% 0.2 180deg)"))return ea(e);const t=Qn({mode:"oklch",l:e.l/100,c:e.c,h:e.h});return t?`rgb(${Math.round(255*t.r)}, ${Math.round(255*t.g)}, ${Math.round(255*t.b)})`:"rgb(0, 0, 0)"}function aa(e){const{h:t,c:n}=e,a={50:95,100:90,200:80,300:70,400:65,500:e.l,600:e.l-10,700:e.l-20,800:e.l-30,900:e.l-40},o={50:.4*n,100:.5*n,200:.6*n,300:.7*n,400:.8*n,500:n,600:.9*n,700:.8*n,800:.7*n,900:.6*n},r={};for(const[i,l]of Object.entries(a)){const e=i,n=ta({l:l,c:o[e],h:t});r[e]=ea(n)}return r}const oa=L("rgb");function ra(e){const t=oa({mode:"oklch",l:e.l/100,c:e.c,h:e.h});if(!t)throw new Error(`Failed to convert OKLCH to RGB: ${JSON.stringify(e)}`);const n=e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4);return.2126*n(t.r)+.7152*n(t.g)+.0722*n(t.b)}function ia(e,t){const n=function(e,t){const n=ra(e),a=ra(t);return(Math.max(n,a)+.05)/(Math.min(n,a)+.05)}(e,t);return{ratio:Math.round(10*n)/10,wcagAA:n>=4.5,wcagAAA:n>=7,wcagAALarge:n>=3}}function la(e,t){const n=e.querySelector("[data-canvas]");if(!n)return;const a=n.getContext("2d");if(!a)return;sa({ctx:a,config:{size:n.width,lightness:t,onColorChange:()=>{}}})}function sa(e){const{ctx:t,config:n}=e,{size:a,lightness:o}=n,r=a/2,i=a/2-10;t.clearRect(0,0,a,a);for(let l=0;l<360;l+=1)for(let e=0;e<=i;e+=i/50){const n=na({l:o,c:e/i*.32,h:l}),a=l*Math.PI/180,s=r+e*Math.cos(a),c=r+e*Math.sin(a);t.fillStyle=n,t.fillRect(s,c,2,2)}t.strokeStyle="#cbd5e1",t.lineWidth=2,t.beginPath(),t.arc(r,r,i,0,2*Math.PI),t.stroke()}function ca(e,t,n){const{canvas:a}=t,o=a.getBoundingClientRect();ua(e.clientX-o.left,e.clientY-o.top,t,n)}function da(e,t,n){const{canvas:a}=t,o=a.getBoundingClientRect(),r=e.touches[0];ua(r.clientX-o.left,r.clientY-o.top,t,n)}function ua(e,t,n,a){const{config:o}=n,{size:r,lightness:i,onColorChange:l}=o,s=r/2,c=r/2-10,d=e-s,u=t-s,h=Math.sqrt(d*d+u*u);if(h>c)return;let p=180*Math.atan2(u,d)/Math.PI;p<0&&(p+=360);const v={l:i,c:Math.min(h/c*.32,.32),h:p};n.currentColor=v,a&&ha(n,a,v),l(v)}function ha(e,t,n){const{config:a}=e,{size:o}=a,r=o/2,i=o/2-10,l=n.c/.32*i,s=n.h*Math.PI/180,c=r+l*Math.cos(s),d=r+l*Math.sin(s);t.style.left=`${c}px`,t.style.top=`${d}px`,t.hidden=!1}function pa(e){const t={mode:"oklch",l:e.l/100,c:e.c,h:e.h};return Kn(t)}function va(t,n,a,r){const i={color:{...n},previousColor:{...n},key:a},l=t.querySelector("[data-lightness]"),s=t.querySelector("[data-chroma]"),c=t.querySelector("[data-hue]"),d=t.querySelector("[data-preview]"),u=t.querySelector("[data-css-value]"),h=t.querySelector("[data-palette]"),p=t.querySelector("[data-hex-input]"),v=t.querySelector("[data-hex-copy]"),g=t.querySelector("[data-selector-2d]");if(!(l&&s&&c&&d&&u))return console.error("Color picker: missing required elements"),()=>{};let m=null;g&&(m=function(e,t,n){const a=e.querySelector("[data-canvas]"),o=e.querySelector("[data-marker]");if(!a)return console.error("2D Color Selector: canvas not found"),()=>{};const r=a.getContext("2d");if(!r)return console.error("2D Color Selector: failed to get canvas context"),()=>{};const i={canvas:a,ctx:r,isDragging:!1,currentColor:t,config:{size:a.width,lightness:t.l,onColorChange:n}};sa(i),o&&ha(i,o,t);const l=e=>{i.isDragging=!0,ca(e,i,o)},s=e=>{i.isDragging&&ca(e,i,o)},c=()=>{i.isDragging=!1},d=e=>{e.preventDefault(),i.isDragging=!0,da(e,i,o)},u=e=>{e.preventDefault(),i.isDragging&&da(e,i,o)},h=e=>{e.preventDefault(),i.isDragging=!1};return a.addEventListener("mousedown",l),a.addEventListener("mousemove",s),a.addEventListener("mouseup",c),a.addEventListener("mouseleave",c),a.addEventListener("touchstart",d,{passive:!1}),a.addEventListener("touchmove",u,{passive:!1}),a.addEventListener("touchend",h,{passive:!1}),()=>{a.removeEventListener("mousedown",l),a.removeEventListener("mousemove",s),a.removeEventListener("mouseup",c),a.removeEventListener("mouseleave",c),a.removeEventListener("touchstart",d),a.removeEventListener("touchmove",u),a.removeEventListener("touchend",h)}}(g,n,e=>{i.color={...e,l:i.color.l},f(),M(),r?.(i.color)}));const f=()=>{const{l:e,c:n,h:a}=i.color,o=na(i.color),r=pa(i.color);l.value=String(e),s.value=String(n),c.value=String(a);const v=t.querySelector("[data-lightness-value]"),g=t.querySelector("[data-chroma-value]"),m=t.querySelector("[data-hue-value]");v&&(v.textContent=`${e}%`),g&&(g.textContent=String(n)),m&&(m.textContent=`${a}°`),p&&p!==document.activeElement&&(p.value=r),d.style.backgroundColor=o,u.textContent=o,h&&function(e,t){const n=aa(t),a=Object.entries(n).map(([e,t])=>`\n        <div\n          class="color-picker__palette-swatch"\n          style="background-color: ${t}"\n          title="${e}: ${t}"\n        >\n          <span class="color-picker__palette-shade">${e}</span>\n        </div>\n      `).join("");e.innerHTML=a}(h,i.color),function(e,t){const n=e.querySelector("[data-contrast-ratio]"),a=e.querySelector("[data-wcag-badge]");if(!n||!a)return;const o=ia(t,{l:95,c:.01,h:0});n.textContent=`${o.ratio}:1`,o.wcagAAA?(a.textContent="AAA",a.className="color-picker__wcag-badge color-picker__wcag-badge--aaa"):o.wcagAA?(a.textContent="AA",a.className="color-picker__wcag-badge color-picker__wcag-badge--aa"):(a.textContent="Fail",a.className="color-picker__wcag-badge color-picker__wcag-badge--fail")}(t,i.color)},b=()=>{i.color.l=parseFloat(l.value),g&&la(g,i.color.l),f(),M(),r?.(i.color)},y=()=>{i.color.c=parseFloat(s.value),f(),M(),r?.(i.color)},_=()=>{i.color.h=parseFloat(c.value),f(),M(),r?.(i.color)},x=()=>{if(!p)return;const e=p.value.trim();if(function(e){return/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i.test(e)}(e)){const t=function(e){try{const t=e.startsWith("#")?e:`#${e}`,n=ae(t);if(!n)return null;const a=L("oklch")(n);return a&&"oklch"===a.mode?{l:100*(a.l??0),c:a.c??0,h:a.h??0}:null}catch(t){return console.error("Failed to convert hex to OKLCH:",t),null}}(e);t&&(i.color=t,f(),M(),r?.(i.color),g&&la(g,t.l),p.classList.remove("color-picker__hex-input--error"))}else p.classList.add("color-picker__hex-input--error")},M=()=>{o(e.COLOR_CHANGE,{color:{...i.color},previousColor:{...i.previousColor},key:i.key}),i.previousColor={...i.color}};return l.addEventListener("input",b),s.addEventListener("input",y),c.addEventListener("input",_),p&&(p.addEventListener("change",x),p.addEventListener("blur",x)),v&&v.addEventListener("click",()=>{(async()=>{if(p)try{if(await navigator.clipboard.writeText(p.value),v){const e=v.textContent;v.textContent="✓",v.classList.add("color-picker__hex-copy--copied"),setTimeout(()=>{v.textContent=e,v.classList.remove("color-picker__hex-copy--copied")},1500)}}catch(e){console.error("Failed to copy hex code:",e)}})()}),f(),()=>{l.removeEventListener("input",b),s.removeEventListener("input",y),c.removeEventListener("input",_),p&&(p.removeEventListener("change",x),p.removeEventListener("blur",x)),m&&m()}}function ga(e,t,n){const a=pa(e),{l:o,c:r,h:i}=e;return`\n    <button\n      class="color-card ${n?"color-card--active":""}"\n      data-color-card="${t}"\n      type="button"\n      aria-label="Select ${t} color for editing"\n      aria-pressed="${n}"\n    >\n      <div class="color-card__preview" style="background-color: ${a}"></div>\n\n      <div class="color-card__info">\n        <div class="color-card__label">\n          ${"primary"===t?"Primary Color":"Secondary Color"}\n          ${n?'<span class="color-card__badge">Editing</span>':""}\n        </div>\n\n        <div class="color-card__hex">${a}</div>\n\n        <div class="color-card__oklch">\n          <span class="oklch-value">L: ${Math.round(o)}%</span>\n          <span class="oklch-value">C: ${Math.round(100*r)}%</span>\n          <span class="oklch-value">H: ${Math.round(i)}°</span>\n        </div>\n      </div>\n    </button>\n  `}const ma={GRADIENT_STEPS:9,GRADIENT_LIGHTNESS_MIN:20,GRADIENT_LIGHTNESS_MAX:95,SHADE_SCALE:[50,100,200,300,400,500,600,700,800,900,950],SHADE_LIGHTNESS_MAP:{50:.97,100:.93,200:.85,300:.73,400:.6,500:.5,600:.42,700:.35,800:.28,900:.22,950:.15},HARMONY_ANGLES:{COMPLEMENTARY:180,TRIADIC:120,ANALOGOUS:30}},fa=[{name:"Electric Blue",color:{l:.55,c:.25,h:250},hex:"#0066ff",category:"vibrant"},{name:"Vivid Red",color:{l:.55,c:.25,h:25},hex:"#ff3333",category:"vibrant"},{name:"Bright Green",color:{l:.6,c:.22,h:145},hex:"#00cc66",category:"vibrant"},{name:"Purple",color:{l:.5,c:.24,h:300},hex:"#9933ff",category:"vibrant"},{name:"Orange",color:{l:.65,c:.2,h:50},hex:"#ff8800",category:"vibrant"},{name:"Cyan",color:{l:.65,c:.18,h:200},hex:"#00ccff",category:"vibrant"},{name:"Soft Pink",color:{l:.8,c:.12,h:15},hex:"#ffccdd",category:"pastel"},{name:"Mint",color:{l:.85,c:.1,h:150},hex:"#ccffee",category:"pastel"},{name:"Lavender",color:{l:.75,c:.12,h:290},hex:"#ddccff",category:"pastel"},{name:"Peach",color:{l:.8,c:.11,h:40},hex:"#ffeedd",category:"pastel"},{name:"Slate",color:{l:.5,c:.02,h:250},hex:"#708090",category:"neutral"},{name:"Stone",color:{l:.55,c:.03,h:60},hex:"#8b8680",category:"neutral"},{name:"Zinc",color:{l:.5,c:.01,h:0},hex:"#7f7f7f",category:"neutral"},{name:"Navy",color:{l:.25,c:.15,h:260},hex:"#001f3f",category:"dark"},{name:"Forest",color:{l:.3,c:.12,h:140},hex:"#0d4d2d",category:"dark"},{name:"Burgundy",color:{l:.3,c:.18,h:20},hex:"#660033",category:"dark"}];function ba(e,t){return ta({l:e.l,c:e.c,h:(e.h+t+360)%360})}function ya(e){const t=function(e,t=ma.GRADIENT_STEPS){const{c:n,h:a}=e,{GRADIENT_LIGHTNESS_MIN:o,GRADIENT_LIGHTNESS_MAX:r}=ma,i=[],l=(r-o)/(t-1);for(let s=0;s<t;s++){const e=r-l*s;i.push(ta({l:e,c:n,h:a}))}return i}(e,ma.GRADIENT_STEPS);return`\n    <div class="color-gradient">\n      <div class="color-gradient__header">\n        <span class="color-gradient__label">Gradient (Light → Dark)</span>\n      </div>\n      <div class="color-gradient__cells">${t.map((e,t)=>{const n=pa(e);return`\n      <div\n        class="color-gradient__cell"\n        style="background-color: ${n}"\n        title="Step ${t+1}: ${n} (L: ${Math.round(e.l)}%)"\n      ></div>\n    `}).join("")}</div>\n    </div>\n  `}function _a(e){const t=function(e){const{c:t,h:n}=e,{SHADE_SCALE:a,SHADE_LIGHTNESS_MAP:o}=ma;return a.map(e=>{const a=ta({l:100*o[e],c:t,h:n});return{weight:e,color:a,hex:pa(a)}})}(e);return`\n    <div class="shade-matrix">\n      <div class="shade-matrix__header">\n        <span class="shade-matrix__label">Shade Scale (TailwindCSS)</span>\n      </div>\n      <div class="shade-matrix__grid">${t.map(({weight:e,color:t,hex:n})=>`\n      <div class="shade-matrix__cell">\n        <div\n          class="shade-matrix__swatch"\n          style="background-color: ${n}"\n          title="${n} (L: ${Math.round(t.l)}%)"\n        ></div>\n        <span class="shade-matrix__weight">${e}</span>\n      </div>\n    `).join("")}</div>\n    </div>\n  `}function xa(e,t){const n=function(e,t){const{l:n,c:a,h:o}=e,r=ma.HARMONY_ANGLES[t.toUpperCase()];let i,l;switch(t){case"complementary":i=[e,ta({l:n,c:a,h:(o+r)%360})],l=["Base","Complement"];break;case"triadic":i=[e,ta({l:n,c:a,h:(o+r)%360}),ta({l:n,c:a,h:(o+2*r)%360})],l=["Base","Triadic 1","Triadic 2"];break;case"analogous":i=[ta({l:n,c:a,h:(o-r+360)%360}),e,ta({l:n,c:a,h:(o+r)%360})],l=["Analogous -30°","Base","Analogous +30°"]}return{type:t,colors:i,names:l}}(e,t),a=n.colors.map((e,a)=>{const o=pa(e),r=n.names[a];return`\n      <div class="harmony-circle ${a===("analogous"===t?1:0)?"harmony-circle--base":""}">\n        <div\n          class="harmony-circle__swatch"\n          style="background-color: ${o}"\n          title="${r}: ${o}"\n        ></div>\n        <span class="harmony-circle__label">${r}</span>\n      </div>\n    `}).join("");return`\n    <div class="harmony-group">\n      <div class="harmony-group__label">${o=t,o.charAt(0).toUpperCase()+o.slice(1)}</div>\n      <div class="harmony-group__circles">${a}</div>\n    </div>\n  `;var o}function Ma(){const e=fa.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return`\n    <div class="color-presets">\n      <div class="color-presets__header">\n        <span class="color-presets__label">Quick Colors</span>\n      </div>\n      <div class="color-presets__groups">${Object.entries(e).map(([e,t])=>function(e,t){const n=t.map(e=>`\n    <button\n      class="preset-cell"\n      data-preset-name="${e.name}"\n      style="background-color: ${e.hex}"\n      title="${e.name} (${e.hex})"\n      type="button"\n      aria-label="Apply ${e.name}"\n    ></button>\n  `).join("");return`\n    <div class="preset-group">\n      <div class="preset-group__label">${a=e,a.charAt(0).toUpperCase()+a.slice(1)}</div>\n      <div class="preset-group__grid">${n}</div>\n    </div>\n  `;var a}(e,t)).join("")}</div>\n    </div>\n  `}async function Ea(e){const t=document.getElementById(e);if(!t)return console.error(`Theme editor: container #${e} not found`),()=>{};const n={isLoading:!0,activeColor:"primary",isSecondaryEnabled:!1};!function(e){e.innerHTML='\n    <div class="theme-editor__loading">\n      <div class="theme-editor__spinner"></div>\n      <p>Loading theme configuration...</p>\n    </div>\n  '}(t);const a=await p();if(!a)return function(e,t){e.innerHTML=`\n    <div class="theme-editor__error">\n      <p class="theme-editor__error-message">${t}</p>\n      <button onclick="window.location.reload()">Reload</button>\n    </div>\n  `}(t,"Failed to load theme configuration"),()=>{};n.isLoading=!1,n.isSecondaryEnabled=null!==a.brand_secondary&&void 0!==a.brand_secondary,Sa(t,a,n);const o=$a(t,a,n);return ka(t,n),()=>{o.forEach(e=>e())}}function Sa(e,t,n){const a=t.brand_primary,o=t.brand_secondary||ba(a,180),r="primary"===n.activeColor?a:o;var i;e.innerHTML=`\n    <div class="theme-editor">\n      <header class="theme-editor__header">\n        <h2 class="theme-editor__title">Theme Editor</h2>\n      </header>\n\n      <div class="theme-editor__content">\n        \x3c!-- Brand Colors Section --\x3e\n        <section class="theme-section">\n          <header class="theme-section__header">\n            <h3 class="theme-section__title">Brand Colors</h3>\n\n            <label class="toggle-switch">\n              <input\n                type="checkbox"\n                data-secondary-toggle\n                ${n.isSecondaryEnabled?"checked":""}\n              />\n              <span class="toggle-switch__slider"></span>\n              <span class="toggle-switch__label">Enable Secondary Color</span>\n            </label>\n          </header>\n\n          <div class="color-cards-container" data-color-cards>\n            ${ga(a,"primary","primary"===n.activeColor)}\n            ${n.isSecondaryEnabled?ga(o,"secondary","secondary"===n.activeColor):""}\n          </div>\n        </section>\n\n        \x3c!-- Color Picker Section (Shared) --\x3e\n        <section class="theme-section">\n          <header class="theme-section__header">\n            <h3 class="theme-section__title">\n              Editing: <span class="color-key-label">${wa(n.activeColor)} Color</span>\n            </h3>\n          </header>\n\n          <div data-color-picker-container></div>\n        </section>\n\n        \x3c!-- Visualizations Section --\x3e\n        <section class="theme-section theme-section--visualizations">\n          <header class="theme-section__header">\n            <h3 class="theme-section__title">Color Analysis</h3>\n          </header>\n\n          <div class="visualizations-grid">\n            ${ya(r)}\n            ${_a(r)}\n            ${i=r,`\n    <div class="color-harmonies">\n      <div class="color-harmonies__header">\n        <span class="color-harmonies__label">Color Harmonies</span>\n      </div>\n      <div class="color-harmonies__groups">${["complementary","triadic","analogous"].map(e=>xa(i,e)).join("")}</div>\n    </div>\n  `}\n            ${Ma()}\n          </div>\n        </section>\n\n        \x3c!-- Theme Settings Section --\x3e\n        <section class="theme-section theme-section--collapsible" data-section="theme-settings">\n          <h3 class="theme-section__title" data-toggle>\n            <span class="theme-section__icon">⚙️</span>\n            <span>Theme Settings</span>\n            <span class="theme-section__arrow">▼</span>\n          </h3>\n\n          <div class="theme-section__content" data-content>\n            \x3c!-- Theme Mode --\x3e\n            <div class="theme-setting-group">\n              <label class="theme-setting__label">Theme Mode</label>\n              <div class="theme-setting__options">\n                ${["auto","light","dark"].map(e=>`\n                  <label class="theme-radio">\n                    <input\n                      type="radio"\n                      name="theme-mode"\n                      value="${e}"\n                      ${t.mode===e?"checked":""}\n                      data-mode-radio\n                    />\n                    <span>${wa(e)}</span>\n                  </label>\n                `).join("")}\n              </div>\n            </div>\n\n            \x3c!-- Neutral Palette --\x3e\n            <div class="theme-setting-group">\n              <label class="theme-setting__label">Neutral Palette</label>\n              <div class="theme-setting__options">\n                ${["slate","gray","zinc","neutral","stone"].map(e=>`\n                  <label class="theme-radio">\n                    <input\n                      type="radio"\n                      name="neutral-palette"\n                      value="${e}"\n                      ${t.neutral===e?"checked":""}\n                      data-neutral-radio\n                    />\n                    <span>${wa(e)}</span>\n                  </label>\n                `).join("")}\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <footer class="theme-editor__footer">\n        <button\n          class="theme-editor__button theme-editor__button--secondary"\n          data-reset-btn\n          disabled\n        >\n          Reset\n        </button>\n        <button\n          class="theme-editor__button theme-editor__button--primary"\n          data-save-btn\n          disabled\n        >\n          💾 Save Changes\n        </button>\n      </footer>\n    </div>\n  `}function wa(e){return e.charAt(0).toUpperCase()+e.slice(1)}function $a(t,n,a){const r=[],i=t.querySelector("[data-color-cards]");i&&function(t){t.addEventListener("click",t=>{const n=t.target.closest("[data-color-card]");if(!n)return;const a=n.getAttribute("data-color-card");o(e.ACTIVE_COLOR_CHANGE,{activeColor:a})})}(i);const l=t.querySelector("[data-color-picker-container]");if(l){const e="primary"===a.activeColor?n.brand_primary:n.brand_secondary||ba(n.brand_primary,180),t="primary"===a.activeColor?"brand_primary":"brand_secondary";l.innerHTML=function(e,t,n){const a=na(n),o=pa(n);return`\n    <div class="color-picker" id="${e}" data-picker>\n      <label class="color-picker__label">\n        ${t}\n        <div class="color-picker__preview" data-preview style="background-color: ${a}"></div>\n      </label>\n\n      \x3c!-- 2D Color Selector --\x3e\n      <div class="color-picker__visual">\n        ${function(e){return`\n    <div class="color-selector-2d" data-selector-2d="${e}">\n      <canvas\n        class="color-selector-2d__canvas"\n        data-canvas\n        width="200"\n        height="200"\n      ></canvas>\n      <div\n        class="color-selector-2d__marker"\n        data-marker\n        hidden\n      ></div>\n    </div>\n  `}(`${e}-selector`,n.l)}\n      </div>\n\n      \x3c!-- Hex Input --\x3e\n      <div class="color-picker__hex">\n        <label for="${e}-hex">\n          Hex Color\n        </label>\n        <div class="color-picker__hex-input">\n          <input\n            type="text"\n            id="${e}-hex"\n            data-hex-input\n            value="${o}"\n            pattern="^#?([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$"\n            placeholder="#000000"\n            maxlength="7"\n            aria-label="Hex color code"\n          />\n          <button\n            type="button"\n            class="color-picker__hex-copy"\n            data-hex-copy\n            title="Copy hex code"\n          >\n            📋\n          </button>\n        </div>\n      </div>\n\n      <div class="color-picker__controls">\n        \x3c!-- Lightness slider (0-100) --\x3e\n        <div class="color-picker__control">\n          <label for="${e}-lightness">\n            Lightness: <span data-lightness-value>${n.l}%</span>\n          </label>\n          <input\n            type="range"\n            id="${e}-lightness"\n            data-lightness\n            min="0"\n            max="100"\n            step="1"\n            value="${n.l}"\n            aria-label="Lightness"\n          />\n        </div>\n\n        \x3c!-- Chroma slider (0-0.4) --\x3e\n        <div class="color-picker__control">\n          <label for="${e}-chroma">\n            Chroma: <span data-chroma-value>${n.c}</span>\n          </label>\n          <input\n            type="range"\n            id="${e}-chroma"\n            data-chroma\n            min="0"\n            max="0.4"\n            step="0.01"\n            value="${n.c}"\n            aria-label="Chroma (saturation)"\n          />\n        </div>\n\n        \x3c!-- Hue slider (0-360) --\x3e\n        <div class="color-picker__control">\n          <label for="${e}-hue">\n            Hue: <span data-hue-value>${n.h}°</span>\n          </label>\n          <input\n            type="range"\n            id="${e}-hue"\n            data-hue\n            min="0"\n            max="360"\n            step="1"\n            value="${n.h}"\n            aria-label="Hue"\n          />\n        </div>\n      </div>\n\n      <div class="color-picker__info">\n        <div class="color-picker__css" data-css-value>\n          ${a}\n        </div>\n        <div class="color-picker__contrast" data-contrast>\n          <span data-contrast-ratio>—</span>\n          <span data-wcag-badge></span>\n        </div>\n      </div>\n\n      <div class="color-picker__palette" data-palette></div>\n    </div>\n  `}(`${a.activeColor}-color`,`${wa(a.activeColor)} Color`,e);const o=l.querySelector("[data-picker]");if(o){const n=va(o,e,t,e=>{m(t,e)});r.push(n)}}const s=t.querySelector(".color-presets");return s&&function(t,n){t.addEventListener("click",t=>{const a=t.target.closest("[data-preset-name]");if(!a)return;const r=a.getAttribute("data-preset-name"),i=fa.find(e=>e.name===r);i&&o(e.COLOR_PRESET_SELECT,{preset:i,targetColor:n})})}(s,a.activeColor),r}function ka(t,a){const r=t.querySelector("[data-save-btn]"),i=t.querySelector("[data-reset-btn]"),l=t.querySelectorAll("[data-mode-radio]"),u=t.querySelectorAll("[data-neutral-radio]"),h=t.querySelector("[data-secondary-toggle]");if(function(e){const t=e.querySelectorAll("[data-section]");t.forEach(e=>{const t=e.querySelector("[data-toggle]"),n=e.querySelector("[data-content]"),a=e.querySelector(".theme-editor__section-arrow");t&&n&&(e.classList.add("is-expanded"),t.addEventListener("click",()=>{e.classList.contains("is-expanded")?(e.classList.remove("is-expanded"),e.classList.add("is-collapsed"),a&&(a.textContent="▶")):(e.classList.remove("is-collapsed"),e.classList.add("is-expanded"),a&&(a.textContent="▼"))}),t.style.cursor="pointer")})}(t),r){const e=async()=>{r.disabled=!0,r.textContent="Saving...";const e=await f();r.disabled=!d,r.textContent="💾 Save Changes",e?function(e,t){const n=document.createElement("div");n.className="theme-editor__toast theme-editor__toast--success",n.textContent=t,e.appendChild(n),setTimeout(()=>n.remove(),3e3)}(t,"Theme saved successfully!"):function(e,t){const n=document.createElement("div");n.className="theme-editor__toast theme-editor__toast--error",n.textContent=t,e.appendChild(n),setTimeout(()=>n.remove(),5e3)}(t,"Failed to save theme")};r.addEventListener("click",()=>{e()})}i&&i.addEventListener("click",()=>{confirm("Reset all changes? This cannot be undone.")&&(c?(s=structuredClone(c),d=!1,o(e.CONFIG_RESET,{theme:s}),o(e.CONFIG_DIRTY,{isDirty:!1})):console.warn("Cannot reset config: no original state"))}),l.forEach(e=>{e.addEventListener("change",()=>{const t=e;t.checked&&m("mode",t.value)})}),u.forEach(e=>{e.addEventListener("change",()=>{const t=e;t.checked&&m("neutral",t.value)})}),h&&h.addEventListener("change",()=>{if(h.checked){const e=v();if(!e)return;m("brand_secondary",ba(e.brand_primary,180)),a.isSecondaryEnabled=!0}else m("brand_secondary",null),a.isSecondaryEnabled=!1,"secondary"===a.activeColor&&(a.activeColor="primary");o(e.SECONDARY_COLOR_TOGGLE,{enabled:h.checked});const n=v();n&&(Sa(t,n,a),$a(t,n,a),ka(t,a))}),n(e.ACTIVE_COLOR_CHANGE,({activeColor:e})=>{a.activeColor=e;const n=v();n&&(Sa(t,n,a),$a(t,n,a),ka(t,a))}),n(e.COLOR_PRESET_SELECT,({preset:e,targetColor:t})=>{m("primary"===t?"brand_primary":"brand_secondary",e.color)}),n(e.CONFIG_DIRTY,({isDirty:e})=>{r&&(r.disabled=!e),i&&(i.disabled=!e)}),n(e.CONFIG_RESET,({theme:e})=>{a.isSecondaryEnabled=null!==e.brand_secondary&&void 0!==e.brand_secondary,Sa(t,e,a),$a(t,e,a),ka(t,a)})}function Ca(e){return"object"==typeof e&&null!==e&&"success"in e&&!1===e.success&&"error"in e}const La={BASE_URL:"http://localhost:4001",TIMEOUT:3e4,MAX_FILE_SIZE:10485760,ALLOWED_IMAGE_TYPES:["image/jpeg","image/png","image/webp","image/gif"]},Ia={HERO:`${La.BASE_URL}/api/content/hero`,SERVICES:`${La.BASE_URL}/api/content/services`,PORTFOLIO:`${La.BASE_URL}/api/content/portfolio`,UPLOAD:`${La.BASE_URL}/api/upload`};async function za(){try{const e=await fetch(Ia.HERO);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=await e.json();if(Ca(t))throw new Error(t.error);return t.hero}catch(t){return console.error("Failed to get hero:",t),o(e.CONFIG_ERROR,{error:t,operation:"getHero"}),null}}async function Oa(){try{const e=await fetch(Ia.SERVICES);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=await e.json();if(Ca(t))throw new Error(t.error);return t.services}catch(t){return console.error("Failed to get services:",t),o(e.CONFIG_ERROR,{error:t,operation:"getServices"}),null}}async function Ta(){try{const e=await fetch(Ia.PORTFOLIO);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=await e.json();if(Ca(t))throw new Error(t.error);return t.portfolio}catch(t){return console.error("Failed to get portfolio:",t),o(e.CONFIG_ERROR,{error:t,operation:"getPortfolio"}),null}}async function Aa(t,n){if(!La.ALLOWED_IMAGE_TYPES.includes(t.type))return o(e.CONFIG_ERROR,{error:new Error(`Invalid file type: ${t.type}`),operation:"upload"}),null;if(t.size>La.MAX_FILE_SIZE)return o(e.CONFIG_ERROR,{error:new Error(`File too large: ${(t.size/1024/1024).toFixed(1)}MB`),operation:"upload"}),null;try{const e=new FormData;return e.append("file",t),new Promise((t,a)=>{const o=new XMLHttpRequest;o.upload.addEventListener("progress",e=>{if(e.lengthComputable&&n){const t=Math.round(e.loaded/e.total*100);n(t)}}),o.addEventListener("load",()=>{if(o.status>=200&&o.status<300)try{const e=JSON.parse(o.responseText);e.success&&e.upload?t(e.upload):a(new Error("Upload failed"))}catch(e){a(e instanceof Error?e:new Error(String(e)))}else a(new Error(`HTTP ${o.status}: ${o.statusText}`))}),o.addEventListener("error",()=>{a(new Error("Network error during upload"))}),o.addEventListener("timeout",()=>{a(new Error("Upload timeout"))}),o.open("POST",Ia.UPLOAD),o.timeout=La.TIMEOUT,o.send(e)})}catch(a){return console.error("Upload failed:",a),o(e.CONFIG_ERROR,{error:a,operation:"upload"}),null}}const Ra={MAX_FILES:10,MAX_FILE_SIZE:10485760,ALLOWED_TYPES:["image/jpeg","image/png","image/webp","image/gif"],DRAG_HOVER_CLASS:"upload-zone--dragover",UPLOADING_CLASS:"upload-zone--uploading",SUCCESS_CLASS:"upload-zone--success"};let qa=[];function Na(e,t={}){const n="string"==typeof e?document.querySelector(e):e;if(!n)return console.warn("Upload container not found"),()=>{};n.querySelector(".upload-zone__droparea")||(n.innerHTML=`\n    <div class="upload-zone__droparea">\n      <svg class="upload-zone__icon" width="48" height="48" viewBox="0 0 24 24">\n        <path fill="currentColor" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>\n      </svg>\n      <p class="upload-zone__text">\n        ${t.multiple?"Drop images here or click to browse (max 10 files)":"Drop an image here or click to browse"}\n      </p>\n      <p class="upload-zone__hint">\n        Supported: JPEG, PNG, WebP, GIF (max 10MB)\n      </p>\n      <input type="file" accept="image/*" style="display: none;" />\n    </div>\n    <div class="upload-zone__progress" style="display: none;">\n      <div class="upload-progress">\n        \x3c!-- Progress items will be added here --\x3e\n      </div>\n    </div>\n    <div class="upload-zone__results" style="display: none;">\n      \x3c!-- Results will be shown here --\x3e\n    </div>\n  `);const a=n.querySelector(".upload-zone__droparea"),o=n.querySelector('input[type="file"]'),r=n.querySelector(".upload-zone__progress");if(!a||!o)return console.warn("Upload components not found"),()=>{};o.multiple=t.multiple??!1,o.accept=Ra.ALLOWED_TYPES.join(",");const i=[],l=e=>{e.preventDefault(),e.stopPropagation()};["dragenter","dragover","dragleave","drop"].forEach(e=>{a.addEventListener(e,l),i.push([a,e,l])});const s=()=>n.classList.add(Ra.DRAG_HOVER_CLASS),c=()=>n.classList.remove(Ra.DRAG_HOVER_CLASS);["dragenter","dragover"].forEach(e=>{a.addEventListener(e,s),i.push([a,e,s])}),["dragleave","drop"].forEach(e=>{a.addEventListener(e,c),i.push([a,e,c])});const d=e=>{const a=e;Fa(Array.from(a.dataTransfer?.files||[]),n,r,t)};a.addEventListener("drop",d),i.push([a,"drop",d]);const u=()=>o.click();a.addEventListener("click",u),i.push([a,"click",u]);const h=e=>{Fa(Array.from(e.target.files||[]),n,r,t)};return o.addEventListener("change",h),i.push([o,"change",h]),()=>{i.forEach(([e,t,n])=>{e.removeEventListener(t,n)})}}async function Fa(e,t,n,a){!a.multiple&&e.length>1&&(e=[e[0]]),e.length>Ra.MAX_FILES&&(alert(`Maximum ${Ra.MAX_FILES} files allowed`),e=e.slice(0,Ra.MAX_FILES));const o=e.filter(e=>Ra.ALLOWED_TYPES.includes(e.type)?!(e.size>Ra.MAX_FILE_SIZE)||(console.warn(`File too large: ${e.name}`),!1):(console.warn(`Invalid file type: ${e.type}`),!1));if(0===o.length)return void alert("No valid files selected");qa=o.map(e=>({file:e,progress:0,status:"pending"})),n&&(n.style.display="block",Pa(n)),t.classList.add(Ra.UPLOADING_CLASS);const r=[];for(let i=0;i<qa.length;i++){const e=qa[i];e.status="uploading",n&&Pa(n);const t=await Aa(e.file,t=>{e.progress=t,n&&Pa(n)});t?(e.status="complete",e.result=t,r.push(t),a.onUpload&&a.onUpload(t),a.autoInsert&&Da(t)):(e.status="error",e.error="Upload failed"),n&&Pa(n)}t.classList.remove(Ra.UPLOADING_CLASS),setTimeout(()=>{t.classList.add(Ra.SUCCESS_CLASS),function(e,t){const n=e.querySelector(".upload-zone__results");if(!n||0===t.length)return;const a=t.map(e=>{const t=e.webp?`${e.webp.compression_ratio.toFixed(1)}% smaller`:"Original format";return`\n      <div class="upload-result">\n        <img\n          src="${e.webp?.url||e.original.url}"\n          alt="Uploaded image"\n          class="upload-result__thumbnail"\n        />\n        <div class="upload-result__info">\n          <p class="upload-result__size">\n            ${e.original.width} × ${e.original.height}px\n          </p>\n          <p class="upload-result__savings">${t}</p>\n        </div>\n      </div>\n    `}).join("");n.innerHTML=`\n    <h4 class="upload-zone__results-title">\n      Uploaded ${t.length} ${1===t.length?"image":"images"}\n    </h4>\n    <div class="upload-results-grid">\n      ${a}\n    </div>\n  `,n.style.display="block",setTimeout(()=>{n.style.display="none"},5e3)}(t,r),a.onBatchComplete&&r.length>0&&a.onBatchComplete(r),setTimeout(()=>{t.classList.remove(Ra.SUCCESS_CLASS),n&&(n.style.display="none"),qa=[]},3e3)},500)}function Pa(e){const t=e.querySelector(".upload-progress");if(!t)return;const n=qa.map(e=>`\n      <div class="upload-progress__item upload-progress__item--${"complete"===e.status?"success":"error"===e.status?"error":"uploading"===e.status?"uploading":"pending"}">\n        <div class="upload-progress__info">\n          <span class="upload-progress__name">${e.file.name}</span>\n          <span class="upload-progress__size">\n            ${(e.file.size/1024).toFixed(1)} KB\n          </span>\n        </div>\n        <div class="upload-progress__bar">\n          <div class="upload-progress__fill" style="width: ${e.progress}%"></div>\n        </div>\n        <span class="upload-progress__percent">${e.progress}%</span>\n      </div>\n    `).join("");t.innerHTML=n}function Da(e){const t=document.querySelector("#content-body");if(!t)return;const n=`\n![Image](${e.webp?.url||e.original.url})\n`,a=t.selectionStart,o=t.selectionEnd,r=t.value;t.value=r.substring(0,a)+n+r.substring(o),t.selectionStart=t.selectionEnd=a+n.length,t.focus(),t.dispatchEvent(new Event("input",{bubbles:!0}))}async function Ga(t){const n=document.getElementById(t);if(!n)return console.warn(`Content editor container not found: ${t}`),()=>{};n.innerHTML='\n    <div class="content-editor">\n      <nav class="content-editor__tabs">\n        <button class="content-editor__tab content-editor__tab--active" data-section="hero">\n          <span class="tab-icon">🎯</span>\n          <span>Hero Section</span>\n        </button>\n        <button class="content-editor__tab" data-section="services">\n          <span class="tab-icon">⚡</span>\n          <span>Services</span>\n        </button>\n        <button class="content-editor__tab" data-section="portfolio">\n          <span class="tab-icon">📂</span>\n          <span>Portfolio</span>\n        </button>\n      </nav>\n\n      <div class="content-editor__panels">\n        <div id="hero-panel" class="content-editor__panel content-editor__panel--active">\n          \x3c!-- Hero editor will be rendered here --\x3e\n        </div>\n        <div id="services-panel" class="content-editor__panel">\n          \x3c!-- Services editor will be rendered here --\x3e\n        </div>\n        <div id="portfolio-panel" class="content-editor__panel">\n          \x3c!-- Portfolio editor will be rendered here --\x3e\n        </div>\n      </div>\n    </div>\n  ';const a=n.querySelectorAll(".content-editor__tab"),r=n.querySelectorAll(".content-editor__panel");a.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.section;a.forEach(e=>e.classList.remove("content-editor__tab--active")),r.forEach(e=>e.classList.remove("content-editor__panel--active")),e.classList.add("content-editor__tab--active");const o=n.querySelector(`#${t}-panel`);o&&o.classList.add("content-editor__panel--active")})});const i=await async function(t){const n=document.getElementById(t);if(!n)return()=>{};const a=await za();if(!a)return n.innerHTML='<div class="error">Failed to load hero data</div>',()=>{};n.innerHTML=`\n    <form class="content-editor__form" id="hero-form">\n      <div class="content-editor__field">\n        <label class="content-editor__label">Heading</label>\n        <input\n          type="text"\n          class="content-editor__input"\n          name="heading"\n          value="${a.heading}"\n          required\n          maxlength="200"\n        />\n      </div>\n\n      <div class="content-editor__field">\n        <label class="content-editor__label">Description</label>\n        <textarea\n          class="content-editor__textarea"\n          name="description"\n          required\n          maxlength="1000"\n          rows="4"\n        >${a.description}</textarea>\n      </div>\n\n      <div class="content-editor__field">\n        <label class="content-editor__label">Button Text</label>\n        <input\n          type="text"\n          class="content-editor__input"\n          name="button_text"\n          value="${a.button_text}"\n          required\n          maxlength="50"\n        />\n      </div>\n\n      <div class="content-editor__field">\n        <label class="content-editor__label">Button Link</label>\n        <input\n          type="text"\n          class="content-editor__input"\n          name="button_link"\n          value="${a.button_link}"\n          required\n          placeholder="#section or https://example.com"\n        />\n      </div>\n\n      <div class="content-editor__field">\n        <label class="content-editor__label">Background Image</label>\n        <input\n          type="text"\n          class="content-editor__input"\n          name="background_image"\n          value="${a.background_image}"\n          required\n          placeholder="img/header.jpg"\n        />\n        <div id="hero-image-upload" class="upload-zone" style="margin-top: 10px;"></div>\n      </div>\n\n      <div class="content-editor__actions">\n        <button type="submit" class="btn btn--primary btn--large">\n          💾 Save Hero Section\n        </button>\n        <button type="button" class="btn btn--secondary" id="hero-reset">\n          ↺ Reset\n        </button>\n      </div>\n    </form>\n  `;const r=Na("#hero-image-upload",{multiple:!1,onUpload:e=>{const t=n.querySelector('[name="background_image"]');t&&e.original&&(t.value=e.original.path)}}),i=n.querySelector("#hero-form"),l=async t=>{t.preventDefault();const n=new FormData(i),a={heading:n.get("heading"),description:n.get("description"),button_text:n.get("button_text"),button_link:n.get("button_link"),background_image:n.get("background_image")};o(e.CONFIG_SAVING,void 0);const r=await async function(t){try{const n=await fetch(Ia.HERO,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hero:t})});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=await n.json();if(Ca(a))throw new Error(a.message||a.error);return o(e.CONFIG_SAVED,{section:"hero",data:t}),a.hero}catch(n){return console.error("Failed to update hero:",n),o(e.CONFIG_ERROR,{error:n,operation:"updateHero"}),null}}(a);r?(alert("Hero section saved successfully!"),o(e.CONFIG_SAVED,{section:"hero"})):alert("Failed to save hero section")},s=n.querySelector("#hero-reset"),c=async()=>{if(confirm("Reset all changes?")){const e=await za();e&&(i.reset(),Object.entries(e).forEach(([e,t])=>{const n=i.querySelector(`[name="${e}"]`);n&&(n.value=t)}))}};return i.addEventListener("submit",e=>{l(e)}),s.addEventListener("click",()=>{c()}),()=>{r()}}("hero-panel"),l=await async function(t){const n=document.getElementById(t);if(!n)return()=>{};const a=await Oa();if(!a)return n.innerHTML='<div class="error">Failed to load services data</div>',()=>{};let r={...a};const i=()=>{n.innerHTML=`\n      <form class="content-editor__form" id="services-form">\n        <div class="content-editor__field">\n          <label class="content-editor__label">Section Heading</label>\n          <input\n            type="text"\n            class="content-editor__input"\n            name="heading"\n            value="${r.heading}"\n            required\n            maxlength="200"\n          />\n        </div>\n\n        <div class="content-editor__array">\n          <div class="content-editor__array-header">\n            <h3>Services</h3>\n            <button type="button" class="btn btn--small btn--primary" id="add-service">\n              + Add Service\n            </button>\n          </div>\n          <div id="services-list" class="content-editor__array-list">\n            ${r.list.map((e,t)=>l(e,t)).join("")}\n          </div>\n        </div>\n\n        <div class="content-editor__actions">\n          <button type="submit" class="btn btn--primary btn--large">\n            💾 Save Services\n          </button>\n          <button type="button" class="btn btn--secondary" id="services-reset">\n            ↺ Reset\n          </button>\n        </div>\n      </form>\n    `,s()},l=(e,t)=>`\n    <div class="service-item" data-index="${t}">\n      <div class="service-item__handle">⋮⋮</div>\n      <div class="service-item__fields">\n        <input\n          type="text"\n          class="content-editor__input content-editor__input--small"\n          placeholder="Icon (e.g., fa-diamond)"\n          data-field="icon"\n          value="${e.icon}"\n          required\n        />\n        <input\n          type="text"\n          class="content-editor__input"\n          placeholder="Title"\n          data-field="title"\n          value="${e.title}"\n          required\n        />\n        <textarea\n          class="content-editor__textarea content-editor__textarea--small"\n          placeholder="Description"\n          data-field="description"\n          required\n          rows="2"\n        >${e.description}</textarea>\n      </div>\n      <button type="button" class="btn btn--danger btn--small" data-action="delete" data-index="${t}">\n        Delete\n      </button>\n    </div>\n  `,s=()=>{const t=n.querySelector("#services-form"),a=n.querySelector("#add-service"),l=n.querySelector("#services-reset");a?.addEventListener("click",()=>{r.list.push({icon:"fa-diamond",title:"New Service",description:"Service description"}),i()}),n.querySelectorAll('[data-action="delete"]').forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.target.dataset.index||"0");confirm("Delete this service?")&&(r.list.splice(t,1),i())})});const s=async a=>{a.preventDefault();const i=t.querySelector('[name="heading"]').value,l=[];n.querySelectorAll(".service-item").forEach(e=>{const t=e.querySelector('[data-field="icon"]').value,n=e.querySelector('[data-field="title"]').value,a=e.querySelector('[data-field="description"]').value;l.push({icon:t,title:n,description:a})});const s={heading:i,list:l};o(e.CONFIG_SAVING,void 0);const c=await async function(t){try{const n=await fetch(Ia.SERVICES,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({services:t})});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=await n.json();if(Ca(a))throw new Error(a.message||a.error);return o(e.CONFIG_SAVED,{section:"services",data:t}),a.services}catch(n){return console.error("Failed to update services:",n),o(e.CONFIG_ERROR,{error:n,operation:"updateServices"}),null}}(s);c?(r=c,alert("Services saved successfully!"),o(e.CONFIG_SAVED,{section:"services"})):alert("Failed to save services")};t?.addEventListener("submit",e=>{s(e)});const c=async()=>{if(confirm("Reset all changes?")){const e=await Oa();e&&(r=e,i())}};l?.addEventListener("click",()=>{c()})};return i(),()=>{}}("services-panel"),s=await async function(t){const n=document.getElementById(t);if(!n)return()=>{};const a=await Ta();if(!a)return n.innerHTML='<div class="error">Failed to load portfolio data</div>',()=>{};let r={...a};const i=()=>{n.innerHTML=`\n      <form class="content-editor__form" id="portfolio-form">\n        <div class="content-editor__field">\n          <label class="content-editor__label">Section Heading</label>\n          <input\n            type="text"\n            class="content-editor__input"\n            name="portfolio_heading"\n            value="${r.portfolio_heading}"\n            required\n            maxlength="200"\n          />\n        </div>\n\n        <div class="content-editor__array">\n          <div class="content-editor__array-header">\n            <h3>Portfolio Items</h3>\n            <button type="button" class="btn btn--small btn--primary" id="add-portfolio-item">\n              + Add Portfolio Item\n            </button>\n          </div>\n          <div id="portfolio-list" class="content-editor__array-list">\n            ${r.portfolio_items.map((e,t)=>l(e,t)).join("")}\n          </div>\n        </div>\n\n        <div class="content-editor__actions">\n          <button type="submit" class="btn btn--primary btn--large">\n            💾 Save Portfolio\n          </button>\n          <button type="button" class="btn btn--secondary" id="portfolio-reset">\n            ↺ Reset\n          </button>\n        </div>\n      </form>\n    `,s()},l=(e,t)=>`\n    <div class="portfolio-item" data-index="${t}">\n      <div class="portfolio-item__preview">\n        <img src="${e.image}" alt="${e.name}" style="width: 100px; height: 100px; object-fit: cover;" />\n      </div>\n      <div class="portfolio-item__fields">\n        <input\n          type="text"\n          class="content-editor__input content-editor__input--small"\n          placeholder="Image path"\n          data-field="image"\n          value="${e.image}"\n          required\n        />\n        <input\n          type="text"\n          class="content-editor__input"\n          placeholder="Project name"\n          data-field="name"\n          value="${e.name}"\n          required\n        />\n        <input\n          type="text"\n          class="content-editor__input content-editor__input--small"\n          placeholder="Category"\n          data-field="category"\n          value="${e.category}"\n          required\n        />\n        <input\n          type="text"\n          class="content-editor__input content-editor__input--small"\n          placeholder="Link"\n          data-field="link"\n          value="${e.link}"\n          required\n        />\n        <textarea\n          class="content-editor__textarea content-editor__textarea--small"\n          placeholder="Description (flip card)"\n          data-field="flip_description"\n          required\n          rows="2"\n        >${e.flip_description}</textarea>\n        <div class="upload-zone upload-zone--inline" id="portfolio-upload-${t}"></div>\n      </div>\n      <button type="button" class="btn btn--danger btn--small" data-action="delete" data-index="${t}">\n        Delete\n      </button>\n    </div>\n  `,s=()=>{const t=n.querySelector("#portfolio-form"),a=n.querySelector("#add-portfolio-item"),l=n.querySelector("#portfolio-reset");r.portfolio_items.forEach((e,t)=>{Na(`#portfolio-upload-${t}`,{multiple:!1,onUpload:e=>{const a=n.querySelector(`[data-index="${t}"]`),o=a?.querySelector('[data-field="image"]');if(o&&e.original){o.value=e.original.path;const t=a?.querySelector("img");t&&(t.src=e.original.url)}}})}),a?.addEventListener("click",()=>{r.portfolio_items.push({image:"img/portfolio/placeholder.jpg",category:"New Category",name:"New Project",link:"#",flip_description:"Project description"}),i()}),n.querySelectorAll('[data-action="delete"]').forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.target.dataset.index||"0");confirm("Delete this portfolio item?")&&(r.portfolio_items.splice(t,1),i())})});const s=async a=>{a.preventDefault();const i=t.querySelector('[name="portfolio_heading"]').value,l=[];n.querySelectorAll(".portfolio-item").forEach(e=>{const t=e.querySelector('[data-field="image"]').value,n=e.querySelector('[data-field="name"]').value,a=e.querySelector('[data-field="category"]').value,o=e.querySelector('[data-field="link"]').value,r=e.querySelector('[data-field="flip_description"]').value;l.push({image:t,name:n,category:a,link:o,flip_description:r})});const s={portfolio_heading:i,portfolio_items:l};o(e.CONFIG_SAVING,void 0);const c=await async function(t){try{const n=await fetch(Ia.PORTFOLIO,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({portfolio:t})});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=await n.json();if(Ca(a))throw new Error(a.message||a.error);return o(e.CONFIG_SAVED,{section:"portfolio",data:t}),a.portfolio}catch(n){return console.error("Failed to update portfolio:",n),o(e.CONFIG_ERROR,{error:n,operation:"updatePortfolio"}),null}}(s);c?(r=c,alert("Portfolio saved successfully!"),o(e.CONFIG_SAVED,{section:"portfolio"})):alert("Failed to save portfolio")};t?.addEventListener("submit",e=>{s(e)});const c=async()=>{if(confirm("Reset all changes?")){const e=await Ta();e&&(r=e,i())}};l?.addEventListener("click",()=>{c()})};return i(),()=>{}}("portfolio-panel");return()=>{i(),l(),s()}}const Ha={currentTheme:null,targetElement:null,isIframe:!1};function ja(e){if(!Ha.targetElement)return void console.warn("Preview manager: no target element");const t=function(e){const t={},n=aa(e.brand_primary);if(Object.entries(n).forEach(([e,n])=>{t[`--color-primary-${e}`]=n}),t["--color-primary"]=na(e.brand_primary),e.brand_secondary){const n=aa(e.brand_secondary);Object.entries(n).forEach(([e,n])=>{t[`--color-secondary-${e}`]=n}),t["--color-secondary"]=na(e.brand_secondary)}return t["--neutral-palette"]=e.neutral,t["--theme-mode"]=e.mode,t}(e);if(Ha.targetElement){const{targetElement:n}=Ha;Object.entries(t).forEach(([e,t])=>{n.style.setProperty(e,t)}),n.setAttribute("data-theme",e.mode)}}function Ua(){const t=document.querySelectorAll("[data-section]"),a=document.querySelectorAll(".dashboard__section"),o=document.getElementById("unsaved-indicator");t.forEach(e=>{e.addEventListener("click",()=>{const n=e.getAttribute("data-section");n&&(!function(e){if(l())try{localStorage.setItem(i,e)}catch(t){console.error("Failed to save active tab:",t)}}(n),t.forEach(e=>e.classList.remove("dashboard__nav-item--active")),e.classList.add("dashboard__nav-item--active"),a.forEach(e=>{e.id.replace("section-","")===n?e.removeAttribute("hidden"):e.setAttribute("hidden","")}))})}),n(e.CONFIG_DIRTY,({isDirty:e})=>{o&&(o.hidden=!e)});const r=document.querySelector('[data-section="preview"]'),s=document.querySelector("[data-preview-target]");r&&s&&r.addEventListener("click",()=>{setTimeout(()=>{s.src&&(s.src=s.src)},100)});const c=document.getElementById("refresh-preview");c&&s&&c.addEventListener("click",()=>{s.src&&(s.src=s.src)});const d=document.getElementById("preview-viewport");d&&s&&d.addEventListener("change",()=>{const e=d.value,t=s.parentElement;if(t)switch(e){case"mobile":t.style.maxWidth="375px";break;case"tablet":t.style.maxWidth="768px";break;default:t.style.maxWidth="100%"}})}function Ba(){const e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e||"[::1]"===e||e.endsWith(".local")}async function Va(t){if(!Ba())return console.warn("Theme editor is disabled (not running on localhost)"),()=>{};const{editorContainerId:a,previewTargetSelector:o}=t,r=await Ea(a);let i=null;return o&&(i=function(t){const a=document.querySelector(t);if(!a)return console.error(`Preview manager: target "${t}" not found`),()=>{};if(Ha.isIframe="IFRAME"===a.tagName,Ha.isIframe){const e=a;e.addEventListener("load",()=>{Ha.targetElement=e.contentDocument?.documentElement||null,Ha.currentTheme&&ja(Ha.currentTheme)})}else Ha.targetElement=a;const o=n(e.CONFIG_LOADED,({theme:e})=>{Ha.currentTheme=e,ja(e)}),r=n(e.CONFIG_CHANGE,({theme:e})=>{Ha.currentTheme=e,ja(e)}),i=n(e.CONFIG_RESET,({theme:e})=>{Ha.currentTheme=e,ja(e)});return()=>{o(),r(),i(),Ha.targetElement=null,Ha.currentTheme=null}}(o)),()=>{r(),i?.()}}!function e(){if(!Ba())return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",e);Ua();const t=document.querySelector("[data-theme-editor]");if(t&&t.id){const e=t.id,n=document.querySelector("[data-preview-target]");Va({editorContainerId:e,previewTargetSelector:n?`#${n.id||""}`:void 0}).catch(e=>{console.error("Failed to initialize theme editor:",e)})}else console.info("Theme editor: no [data-theme-editor] container found");const n=document.querySelector("[data-content-editor]");n&&n.id?Ga(n.id).catch(e=>{console.error("Failed to initialize content editor:",e)}):console.info("Content editor: no [data-content-editor] container found")}();