# Phase 6: Advanced Features - Implementation Plan
**Document ID**: 07-20251001-001.06
**Created**: October 1, 2025
**Phase Duration**: Week 6-8 (16-20 hours)
**Priority**: üü¢ Medium - Enhanced developer experience
**Dependencies**: Phase 5 complete (QA systems)
**Parent Plan**: 01-20251001-001.00-architectural-improvements.md

---

## Overview

Implement advanced features for improved developer experience and site performance, including local development dashboard and comprehensive performance optimization.

---

## Phase Goals

- ‚úÖ Build onboard dashboard (local config editor)
- ‚úÖ Performance optimization (Lighthouse 95+)
- ‚úÖ Image optimization pipeline
- ‚úÖ Font optimization

---

## Task Breakdown

### Task 6.1: Onboard Dashboard - Phase 1 (Read-Only)
**Priority**: High
**Duration**: 4-5 hours
**Goal**: Local dashboard for viewing configuration

#### Architecture Overview

```
_onboard/
‚îú‚îÄ‚îÄ index.html              # Dashboard UI
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.css       # Dashboard styles
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.js        # Dashboard logic
‚îÇ   ‚îî‚îÄ‚îÄ favicon.svg         # Dashboard favicon
‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îî‚îÄ‚îÄ .credentials        # Local auth (gitignored)
‚îî‚îÄ‚îÄ README.md              # Dashboard documentation
```

#### Security Requirements

**CRITICAL**: Dashboard must ONLY work on localhost
1. Disabled in production builds
2. Host validation
3. Optional password protection
4. No remote access

#### Implementation Steps

**Step 1**: Add dashboard configuration to _config.yml
```yaml
# _config.yml

# Onboard Dashboard (local development only)
onboard:
  enabled: true  # Only works when JEKYLL_ENV != 'production'
  require_auth: false  # Set true for password protection
  host_whitelist:
    - localhost
    - 127.0.0.1
    - 0.0.0.0
```

**Step 2**: Create dashboard HTML
```html
<!-- _onboard/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Onboard - Jekyll Configuration Dashboard</title>
  <link rel="stylesheet" href="assets/dashboard.css">
</head>
<body>
  <div class="dashboard">
    <header class="dashboard__header">
      <h1>üé® Onboard Dashboard</h1>
      <p>Local development configuration viewer</p>
      <span class="dashboard__badge">Read-Only Mode</span>
    </header>

    <nav class="dashboard__nav">
      <button class="dashboard__nav-item dashboard__nav-item--active" data-section="theme">
        Theme
      </button>
      <button class="dashboard__nav-item" data-section="content">
        Content
      </button>
      <button class="dashboard__nav-item" data-section="preview">
        Preview
      </button>
    </nav>

    <main class="dashboard__content">
      <!-- Theme Section -->
      <section id="section-theme" class="dashboard__section">
        <h2>Theme Configuration</h2>

        <div class="config-group">
          <label>Primary Brand Color</label>
          <div class="color-display" id="current-primary">
            <span class="color-swatch"></span>
            <span class="color-label">Blue</span>
          </div>
        </div>

        <div class="config-group">
          <label>Secondary Brand Color</label>
          <div class="color-display" id="current-secondary">
            <span class="color-swatch"></span>
            <span class="color-label">Green</span>
          </div>
        </div>

        <div class="config-group">
          <label>Neutral Palette</label>
          <div class="config-value" id="current-neutral">Slate</div>
        </div>

        <div class="config-group">
          <label>Theme Mode</label>
          <div class="config-value" id="current-mode">Light</div>
        </div>

        <div class="palette-preview">
          <h3>Current Palette</h3>
          <div class="palette-shades" id="palette-display">
            <!-- Generated dynamically -->
          </div>
        </div>
      </section>

      <!-- Content Section -->
      <section id="section-content" class="dashboard__section" hidden>
        <h2>Content Configuration</h2>

        <div class="config-group">
          <label>Hero Heading</label>
          <div class="config-value" id="hero-heading"></div>
        </div>

        <div class="config-group">
          <label>Services Count</label>
          <div class="config-value" id="services-count"></div>
        </div>

        <div class="config-group">
          <label>Portfolio Items</label>
          <div class="config-value" id="portfolio-count"></div>
        </div>
      </section>

      <!-- Preview Section -->
      <section id="section-preview" class="dashboard__section" hidden>
        <h2>Live Preview</h2>

        <div class="preview-controls">
          <button class="btn" id="refresh-preview">Refresh Preview</button>
          <select id="preview-viewport">
            <option value="desktop">Desktop (1920px)</option>
            <option value="tablet">Tablet (768px)</option>
            <option value="mobile">Mobile (375px)</option>
          </select>
        </div>

        <iframe id="site-preview" src="http://localhost:4000" frameborder="0"></iframe>
      </section>
    </main>

    <footer class="dashboard__footer">
      <p>‚ö†Ô∏è This dashboard only works on localhost</p>
      <p>Production builds automatically disable this feature</p>
    </footer>
  </div>

  <script src="assets/dashboard.js"></script>
</body>
</html>
```

**Step 3**: Create dashboard styles
```css
/* _onboard/assets/dashboard.css */

:root {
  --dashboard-primary: #3b82f6;
  --dashboard-bg: #f8fafc;
  --dashboard-surface: #ffffff;
  --dashboard-text: #0f172a;
  --dashboard-border: #e2e8f0;
  --dashboard-success: #22c55e;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--dashboard-bg);
  color: var(--dashboard-text);
}

.dashboard {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.dashboard__header {
  background: var(--dashboard-surface);
  padding: 2rem;
  border-bottom: 1px solid var(--dashboard-border);
  text-align: center;
}

.dashboard__header h1 {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.dashboard__badge {
  display: inline-block;
  background: var(--dashboard-success);
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 1rem;
  font-size: 0.875rem;
  font-weight: 600;
  margin-top: 1rem;
}

.dashboard__nav {
  background: var(--dashboard-surface);
  border-bottom: 1px solid var(--dashboard-border);
  display: flex;
  gap: 0.5rem;
  padding: 1rem;
  overflow-x: auto;
}

.dashboard__nav-item {
  padding: 0.5rem 1.5rem;
  border: none;
  background: transparent;
  cursor: pointer;
  font-size: 1rem;
  border-radius: 0.5rem;
  transition: all 0.2s;

  &:hover {
    background: var(--dashboard-bg);
  }

  &--active {
    background: var(--dashboard-primary);
    color: white;
  }
}

.dashboard__content {
  flex: 1;
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  width: 100%;
}

.dashboard__section {
  background: var(--dashboard-surface);
  padding: 2rem;
  border-radius: 0.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.config-group {
  margin-bottom: 1.5rem;

  label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--dashboard-text);
  }
}

.config-value {
  padding: 0.75rem;
  background: var(--dashboard-bg);
  border-radius: 0.375rem;
  font-family: 'Monaco', 'Courier New', monospace;
}

.color-display {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem;
  background: var(--dashboard-bg);
  border-radius: 0.375rem;
}

.color-swatch {
  width: 48px;
  height: 48px;
  border-radius: 0.375rem;
  border: 2px solid var(--dashboard-border);
}

.palette-preview {
  margin-top: 2rem;

  h3 {
    margin-bottom: 1rem;
  }
}

.palette-shades {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 0.5rem;
}

.palette-shade {
  aspect-ratio: 1;
  border-radius: 0.375rem;
  display: flex;
  align-items: flex-end;
  padding: 0.5rem;
  font-size: 0.75rem;
  font-weight: 600;
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.preview-controls {
  display: flex;
  gap: 1rem;
  margin-bottom: 1rem;
}

.btn {
  padding: 0.5rem 1rem;
  background: var(--dashboard-primary);
  color: white;
  border: none;
  border-radius: 0.375rem;
  cursor: pointer;
  font-size: 0.875rem;

  &:hover {
    opacity: 0.9;
  }
}

#site-preview {
  width: 100%;
  height: 600px;
  border: 2px solid var(--dashboard-border);
  border-radius: 0.5rem;
}

.dashboard__footer {
  background: var(--dashboard-surface);
  border-top: 1px solid var(--dashboard-border);
  padding: 1rem;
  text-align: center;
  font-size: 0.875rem;
  color: #64748b;
}
```

**Step 4**: Create dashboard JavaScript
```javascript
// _onboard/assets/dashboard.js

(function() {
  'use strict';

  // Configuration loaded from Jekyll
  let siteConfig = null;

  // Initialize dashboard
  async function init() {
    // Security check: Only run on localhost
    if (!isLocalhost()) {
      document.body.innerHTML = '<div style="padding: 2rem; text-align: center;"><h1>‚ö†Ô∏è Access Denied</h1><p>This dashboard only works on localhost.</p></div>';
      return;
    }

    // Load site configuration
    await loadConfig();

    // Render sections
    renderThemeSection();
    renderContentSection();

    // Setup navigation
    setupNavigation();
  }

  function isLocalhost() {
    const hostname = window.location.hostname;
    return hostname === 'localhost' ||
           hostname === '127.0.0.1' ||
           hostname === '0.0.0.0' ||
           hostname === '';
  }

  async function loadConfig() {
    try {
      // In Phase 1, we'll hardcode the config
      // In Phase 2, we'll fetch from Jekyll data endpoint
      siteConfig = {
        theme: {
          brand_primary: 'blue',
          brand_secondary: 'green',
          neutral: 'slate',
          mode: 'light'
        },
        hero: {
          heading: 'IT Leadership Portfolio'
        },
        services: {
          list: []  // Count will be shown
        },
        portfolio_items: []
      };

      // TODO Phase 2: Fetch from Jekyll
      // const response = await fetch('/api/config');
      // siteConfig = await response.json();

    } catch (error) {
      console.error('Failed to load config:', error);
    }
  }

  function renderThemeSection() {
    const colorMap = {
      orange: '#f97316',
      blue: '#3b82f6',
      green: '#22c55e',
      purple: '#a855f7',
      red: '#ef4444'
    };

    // Primary color
    const primarySwatch = document.querySelector('#current-primary .color-swatch');
    const primaryLabel = document.querySelector('#current-primary .color-label');
    primarySwatch.style.backgroundColor = colorMap[siteConfig.theme.brand_primary];
    primaryLabel.textContent = capitalize(siteConfig.theme.brand_primary);

    // Secondary color
    if (siteConfig.theme.brand_secondary) {
      const secondarySwatch = document.querySelector('#current-secondary .color-swatch');
      const secondaryLabel = document.querySelector('#current-secondary .color-label');
      secondarySwatch.style.backgroundColor = colorMap[siteConfig.theme.brand_secondary];
      secondaryLabel.textContent = capitalize(siteConfig.theme.brand_secondary);
    } else {
      document.querySelector('#current-secondary .color-label').textContent = 'None';
    }

    // Neutral and mode
    document.getElementById('current-neutral').textContent = capitalize(siteConfig.theme.neutral);
    document.getElementById('current-mode').textContent = capitalize(siteConfig.theme.mode);

    // Render palette shades
    renderPaletteShades(siteConfig.theme.brand_primary, colorMap);
  }

  function renderPaletteShades(palette, colorMap) {
    const paletteDisplay = document.getElementById('palette-display');

    // Tailwind color shades (would load from _data/color-palettes.yml in real implementation)
    const shades = {
      blue: {
        50: '#eff6ff',
        100: '#dbeafe',
        200: '#bfdbfe',
        300: '#93c5fd',
        400: '#60a5fa',
        500: '#3b82f6',
        600: '#2563eb',
        700: '#1d4ed8',
        800: '#1e40af',
        900: '#1e3a8a'
      }
      // ... other palettes
    };

    const colors = shades[palette] || {};
    paletteDisplay.innerHTML = '';

    Object.entries(colors).forEach(([shade, hex]) => {
      const shadeEl = document.createElement('div');
      shadeEl.className = 'palette-shade';
      shadeEl.style.backgroundColor = hex;
      shadeEl.textContent = shade;
      paletteDisplay.appendChild(shadeEl);
    });
  }

  function renderContentSection() {
    document.getElementById('hero-heading').textContent = siteConfig.hero.heading;
    document.getElementById('services-count').textContent = siteConfig.services.list.length;
    document.getElementById('portfolio-count').textContent = siteConfig.portfolio_items.length;
  }

  function setupNavigation() {
    const navItems = document.querySelectorAll('.dashboard__nav-item');
    const sections = document.querySelectorAll('.dashboard__section');

    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const sectionId = item.dataset.section;

        // Update active nav
        navItems.forEach(nav => nav.classList.remove('dashboard__nav-item--active'));
        item.classList.add('dashboard__nav-item--active');

        // Show section
        sections.forEach(section => section.hidden = true);
        document.getElementById(`section-${sectionId}`).hidden = false;
      });
    });

    // Preview refresh
    document.getElementById('refresh-preview')?.addEventListener('click', () => {
      const iframe = document.getElementById('site-preview');
      iframe.src = iframe.src;
    });

    // Viewport selector
    document.getElementById('preview-viewport')?.addEventListener('change', (e) => {
      const iframe = document.getElementById('site-preview');
      const widths = {
        desktop: '100%',
        tablet: '768px',
        mobile: '375px'
      };
      iframe.style.width = widths[e.target.value];
    });
  }

  function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }

  // Initialize when DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }

})();
```

**Step 5**: Add Jekyll exclusion
```yaml
# _config.yml

exclude:
  - _tests_/
  - _onboard/  # Exclude from production builds
```

**Step 6**: Create access instructions
```markdown
<!-- _onboard/README.md -->

# Onboard Dashboard

Local development configuration viewer for Modern Jekyll.

## Access

```
http://localhost:4000/_onboard/
```

**Security**: Only works on localhost. Production builds automatically exclude this directory.

## Features (Phase 1 - Read-Only)

- View current theme configuration
- View color palettes
- View content statistics
- Live site preview

## Future (Phase 2)

- Edit theme colors
- Update content
- Save changes to _config.yml
- Auto-rebuild site
```

#### Testing Checklist
- [ ] Dashboard loads on localhost:4000/_onboard/
- [ ] Dashboard blocked on non-localhost
- [ ] Theme configuration displays correctly
- [ ] Color swatches accurate
- [ ] Preview iframe works
- [ ] Navigation between sections works

---

### Task 6.2: Performance Optimization
**Priority**: High
**Duration**: 4-5 hours
**Goal**: Lighthouse score 95+

#### Optimization Areas

**Step 1**: Image Optimization

Create image optimization script:
```bash
#!/bin/bash
# _tests_/optimize-images.sh

echo "Optimizing portfolio images..."

# Convert to WebP
for img in img/portfolio/*.jpg; do
  cwebp -q 85 "$img" -o "${img%.jpg}.webp"
done

# Generate responsive sizes
for img in img/portfolio/*.jpg; do
  convert "$img" -resize 650x "$img"
  convert "$img" -resize 480x "${img%.jpg}-mobile.jpg"
done

echo "‚úÖ Images optimized"
```

Update HTML for responsive images:
```html
<!-- _includes/portfolio.html -->
<picture>
  <source
    srcset="{{ item.image | replace: '.jpg', '.webp' }}"
    type="image/webp">
  <source
    srcset="{{ item.image }}"
    media="(min-width: 768px)">
  <source
    srcset="{{ item.image | replace: '.jpg', '-mobile.jpg' }}"
    media="(max-width: 767px)">
  <img
    src="{{ item.image }}"
    alt="{{ item.name | escape }}"
    loading="lazy"
    decoding="async"
    class="portfolio-box__image">
</picture>
```

**Step 2**: Font Optimization

Self-host fonts:
```bash
# Download fonts
mkdir -p fonts/
curl -o fonts/open-sans-v28-latin-regular.woff2 \
  "https://fonts.gstatic.com/s/opensans/..."
```

Update head.html:
```html
<!-- _includes/head.html -->

<!-- BEFORE: -->
<link href='https://fonts.googleapis.com/css?family=Open+Sans:...' rel='stylesheet'>

<!-- AFTER: -->
<link rel="preload" href="/fonts/open-sans-v28-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/merriweather-v28-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

<style>
  @font-face {
    font-family: 'Open Sans';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url('/fonts/open-sans-v28-latin-regular.woff2') format('woff2');
  }
  /* ... other font-face declarations */
</style>
```

**Step 3**: Critical CSS

Create critical CSS extractor:
```bash
npm install --save-dev critical
```

Add script:
```javascript
// _tests_/extract-critical-css.js
const critical = require('critical');

critical.generate({
  inline: true,
  base: '_site/',
  src: 'index.html',
  target: 'index.html',
  width: 1920,
  height: 1080,
  dimensions: [{
    width: 375,
    height: 667
  }, {
    width: 1920,
    height: 1080
  }]
});
```

**Step 4**: Defer non-critical CSS

```html
<!-- _includes/head.html -->

<!-- Critical CSS inlined above -->

<!-- Defer non-critical CSS -->
<link rel="preload" href="{{ '/css/main.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="{{ '/css/main.css' | relative_url }}"></noscript>
```

**Step 5**: JavaScript optimization

```html
<!-- _includes/scripts.html -->

<!-- Defer non-critical scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" defer></script>
<script src="{{ '/js/wow.min.js' | relative_url }}" defer></script>
<script src="{{ '/js/creative.js' | relative_url }}" defer></script>
```

**Step 6**: Add resource hints

```html
<!-- _includes/head.html -->

<!-- DNS prefetch for external resources -->
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">

<!-- Preconnect to critical origins -->
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
```

#### Testing Checklist
- [ ] Lighthouse Performance: 95+
- [ ] Lighthouse Accessibility: 100
- [ ] Lighthouse Best Practices: 95+
- [ ] Lighthouse SEO: 100
- [ ] First Contentful Paint < 1.8s
- [ ] Largest Contentful Paint < 2.5s
- [ ] Cumulative Layout Shift < 0.1
- [ ] Time to Interactive < 3.8s

---

## Phase 6 Success Metrics

### Dashboard
- [ ] Loads in < 500ms
- [ ] Read-only mode functional
- [ ] Security validation works
- [ ] Preview accurate

### Performance
- [ ] Lighthouse: 95+ all categories
- [ ] Core Web Vitals: All green
- [ ] Page size < 1MB
- [ ] Image formats: WebP supported

---

## Deliverables

### Code
- [ ] `_onboard/` dashboard directory
- [ ] Image optimization scripts
- [ ] Font optimization
- [ ] Critical CSS extraction

### Documentation
- [ ] Dashboard README
- [ ] Performance optimization guide
- [ ] Lighthouse reports (before/after)

---

## Sign-Off

### Completed Tasks
- [ ] Task 6.1: Onboard dashboard (read-only)
- [ ] Task 6.2: Performance optimization

### Phase 6 Complete
- [ ] Dashboard functional
- [ ] Performance optimized
- [ ] All phases complete ‚úÖ

**Completed By**: _____________
**Date**: _____________

---

**Document Status**: ‚úÖ Ready for Implementation
**Last Updated**: October 1, 2025
**Project**: Modern Jekyll - All Phases Complete!
