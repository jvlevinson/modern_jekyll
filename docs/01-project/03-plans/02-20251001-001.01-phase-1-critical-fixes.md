# Phase 1: Critical Fixes - Implementation Plan
**Document ID**: 02-20251001-001.01
**Created**: October 1, 2025
**Phase Duration**: Week 1 (8-12 hours)
**Priority**: ðŸ”´ Critical - Immediate user-facing issues
**Dependencies**: None
**Parent Plan**: 01-20251001-001.00-architectural-improvements.md

---

## Overview

This phase addresses critical UI/UX issues that affect user experience in both light and dark themes. All issues are currently visible in production and impact usability.

---

## Phase Goals

- âœ… Fix theme toggle visibility in navbar
- âœ… Prevent logo shrinking on scroll
- âœ… Ensure WCAG AA contrast compliance in dark mode
- âœ… Improve hero text readability

---

## Task Breakdown

### Task 1.1: Fix Theme Toggle Visibility in Navbar
**Priority**: Critical
**Duration**: 1.5 hours
**Issue**: Theme toggle washes out when navbar becomes solid white on scroll

#### Current Behavior
```scss
// _sass/layout/_navigation.scss
#mainNav.navbar-shrink {
  background-color: #fff;
  // Theme toggle color doesn't adapt
}
```

#### Files to Modify
1. `_sass/layout/_navigation.scss`
2. `_sass/components/_theme-toggle.scss` (create if doesn't exist)

#### Implementation Steps

**Step 1**: Check current navigation SCSS structure
```bash
# Read the navigation file to understand current implementation
```

**Step 2**: Add theme toggle state handling
```scss
// _sass/layout/_navigation.scss

#mainNav {
  // Default state (transparent navbar)
  .theme-toggle {
    color: var(--color-text-inverse);
    transition: color var(--transition-normal);

    &:hover,
    &:focus {
      color: var(--color-primary-light);
      transform: scale(1.1);
    }
  }

  // Scrolled state (solid white navbar)
  &.navbar-shrink {
    background-color: rgba(255, 255, 255, 0.95);
    border-bottom: 1px solid var(--color-border);

    .theme-toggle {
      color: var(--color-text);  // Dark color for white bg

      &:hover,
      &:focus {
        color: var(--color-primary);
      }
    }

    // Navbar links should also adapt
    .navbar-nav .nav-link {
      color: var(--color-text);

      &:hover,
      &:focus {
        color: var(--color-primary);
      }
    }
  }
}

// Dark mode adjustments
[data-theme="dark"] {
  #mainNav {
    &.navbar-shrink {
      background-color: rgba(15, 23, 42, 0.95);
      border-bottom: 1px solid var(--color-border);

      .theme-toggle {
        color: var(--color-text-inverse);

        &:hover {
          color: var(--color-primary-light);
        }
      }
    }
  }
}
```

**Step 3**: Update theme toggle HTML structure (if needed)
```html
<!-- _includes/nav.html -->
<button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
  <span class="theme-icon theme-icon-light active">
    <i class="fa-solid fa-sun"></i>
  </span>
  <span class="theme-icon theme-icon-dark">
    <i class="fa-solid fa-moon"></i>
  </span>
</button>
```

**Step 4**: Add theme toggle component styles
```scss
// _sass/components/_theme-toggle.scss
.theme-toggle {
  background: transparent;
  border: none;
  cursor: pointer;
  padding: var(--space-xs);
  font-size: 1.25rem;
  transition: all var(--transition-normal);
  position: relative;

  &:hover {
    transform: scale(1.1);
  }

  &:focus {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  .theme-icon {
    display: none;
    transition: opacity var(--transition-fast);

    &.active {
      display: inline-block;
    }
  }
}
```

**Step 5**: Update component index
```scss
// _sass/components/_index.scss
@forward 'theme-toggle';  // Add this line
```

#### Testing Checklist
- [ ] Light mode: Theme toggle visible on transparent navbar
- [ ] Light mode: Theme toggle visible on white navbar (scrolled)
- [ ] Dark mode: Theme toggle visible on transparent navbar
- [ ] Dark mode: Theme toggle visible on dark navbar (scrolled)
- [ ] Hover states work in all scenarios
- [ ] Click functionality preserved
- [ ] Focus indicator visible
- [ ] Contrast ratio meets WCAG AA (4.5:1)

#### Success Criteria
- Theme toggle always visible with minimum 4.5:1 contrast
- Smooth transitions between states
- No visual glitches during scroll

---

### Task 1.2: Fix Logo Shrinking on Scroll
**Priority**: Critical
**Duration**: 1 hour
**Issue**: Brand logo shrinks when navbar transitions to solid state

#### Current Behavior
```scss
// Likely in _sass/layout/_navigation.scss
#mainNav.navbar-shrink {
  // Applies size reduction to all content
}
```

#### Files to Modify
1. `_sass/layout/_navigation.scss`

#### Implementation Steps

**Step 1**: Identify current logo sizing
```bash
# Check navigation file for .navbar-brand styles
```

**Step 2**: Lock logo size
```scss
// _sass/layout/_navigation.scss

#mainNav {
  .navbar-brand {
    font-size: 1.5rem;
    font-weight: var(--font-weight-bold);
    color: var(--color-text-inverse);
    transition: color var(--transition-normal);
    // NO size transition!

    // If using image logo:
    img {
      height: 40px;
      width: auto;
      transition: none;  // Prevent shrinking
    }

    &:hover,
    &:focus {
      color: var(--color-primary-light);
    }
  }

  &.navbar-shrink {
    .navbar-brand {
      font-size: 1.5rem;  // Same size as default
      color: var(--color-text);

      // If using image logo:
      img {
        height: 40px;  // Same height as default
      }
    }
  }
}

// Dark mode
[data-theme="dark"] {
  #mainNav {
    .navbar-brand {
      color: var(--color-text-inverse);
    }

    &.navbar-shrink {
      .navbar-brand {
        color: var(--color-text-inverse);
      }
    }
  }
}
```

**Step 3**: Verify navbar height is appropriate
```scss
#mainNav {
  min-height: 60px;  // Ensure enough space for logo
  padding: var(--space-sm) 0;

  &.navbar-shrink {
    min-height: 60px;  // Keep same height
    padding: var(--space-sm) 0;
  }
}
```

#### Testing Checklist
- [ ] Logo size consistent on page load
- [ ] Logo size unchanged when scrolling down
- [ ] Logo size unchanged when scrolling up
- [ ] Logo size consistent in light mode
- [ ] Logo size consistent in dark mode
- [ ] Logo alignment unchanged
- [ ] Navbar height accommodates logo

#### Success Criteria
- Logo maintains consistent size (40px height or 1.5rem font-size)
- No visual jank during scroll
- Navbar height appropriate for logo

---

### Task 1.3: Improve Dark Mode Hover Contrast
**Priority**: Critical
**Duration**: 3-4 hours
**Issue**: Hover effects don't contrast well in dark mode (WCAG violations)

#### Current Issues Identified
1. Navigation link hovers
2. Button hover states
3. Portfolio box overlays
4. Link colors in text sections

#### Files to Modify
1. `_includes/design-tokens.html`
2. `_sass/base/_typography.scss`
3. `_sass/components/_buttons.scss`
4. `_sass/layout/_navigation.scss`
5. `_sass/components/_portfolio-box.scss`

#### Implementation Steps

**Step 1**: Add dark mode hover tokens
```liquid
<!-- _includes/design-tokens.html -->

[data-theme="dark"] {
  /* Enhanced hover states for dark mode */
  --color-hover-bg: var(--color-primary-300);
  --color-hover-bg-subtle: var(--color-primary-800);
  --color-hover-text: var(--color-neutral-900);
  --color-link-hover: var(--color-primary-200);

  /* Navigation specific */
  --nav-link-hover: var(--color-primary-300);
  --nav-link-active: var(--color-primary-200);

  /* Button hover enhancements */
  --btn-hover-primary: var(--color-primary-300);
  --btn-hover-outline: var(--color-primary-200);
}
```

**Step 2**: Update navigation hover states
```scss
// _sass/layout/_navigation.scss

.navbar-nav {
  .nav-link {
    color: var(--color-text-inverse);
    transition: all var(--transition-normal);
    position: relative;

    &:hover,
    &:focus {
      color: var(--color-primary-light);
    }

    // Active state
    &.active {
      color: var(--color-primary);
    }
  }
}

// Dark mode specific
[data-theme="dark"] {
  .navbar-nav .nav-link {
    &:hover,
    &:focus {
      color: var(--nav-link-hover);
      // Add subtle background for extra visibility
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius-sm);
    }

    &.active {
      color: var(--nav-link-active);
    }
  }
}
```

**Step 3**: Update button hover states
```scss
// _sass/components/_buttons.scss

.btn-primary {
  background-color: var(--color-primary);
  color: var(--color-text-inverse);
  border: 2px solid var(--color-primary);

  &:hover,
  &:focus {
    background-color: var(--color-primary-hover);
    border-color: var(--color-primary-hover);
    color: var(--color-text-inverse);
  }
}

// Dark mode enhancements
[data-theme="dark"] {
  .btn-primary {
    &:hover,
    &:focus {
      background-color: var(--btn-hover-primary);
      border-color: var(--btn-hover-primary);
      color: var(--color-neutral-900);  // Dark text on light button
      box-shadow: 0 0 20px rgba(var(--color-primary-400-rgb), 0.3);
    }
  }

  .btn-default,
  .btn-outline-secondary {
    &:hover,
    &:focus {
      background-color: var(--btn-hover-outline);
      border-color: var(--btn-hover-outline);
      color: var(--color-neutral-900);
    }
  }
}
```

**Step 4**: Update link colors
```scss
// _sass/base/_typography.scss

a {
  color: var(--color-primary);
  text-decoration: none;
  transition: all var(--transition-normal);

  &:hover,
  &:focus {
    color: var(--color-primary-dark);
    text-decoration: underline;
  }
}

// Dark mode
[data-theme="dark"] {
  a {
    color: var(--color-primary-400);

    &:hover,
    &:focus {
      color: var(--color-link-hover);
      text-decoration: underline;
      text-decoration-color: var(--color-primary-300);
    }
  }
}
```

**Step 5**: Update portfolio hover overlays
```scss
// _sass/components/_portfolio-box.scss

.portfolio-box-caption {
  background: color-mix(in srgb, var(--color-primary) 90%, transparent);

  .project-category,
  .project-name {
    color: var(--color-text-inverse);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }
}

// Dark mode
[data-theme="dark"] {
  .portfolio-box-caption {
    background: color-mix(in srgb, var(--color-primary-300) 85%, black 15%);

    .project-category,
    .project-name {
      color: var(--color-neutral-900);
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.2);
    }
  }
}
```

#### Testing Checklist - Contrast Ratios (WCAG AA = 4.5:1)

**Navigation**
- [ ] Nav link hover (light mode): ___:1 (target: 4.5:1)
- [ ] Nav link hover (dark mode): ___:1 (target: 4.5:1)
- [ ] Active nav link (light mode): ___:1
- [ ] Active nav link (dark mode): ___:1

**Buttons**
- [ ] Primary button hover (light mode): ___:1
- [ ] Primary button hover (dark mode): ___:1
- [ ] Outline button hover (light mode): ___:1
- [ ] Outline button hover (dark mode): ___:1

**Links**
- [ ] Body text links (light mode): ___:1
- [ ] Body text links (dark mode): ___:1
- [ ] Link hover (light mode): ___:1
- [ ] Link hover (dark mode): ___:1

**Portfolio**
- [ ] Portfolio overlay text (light mode): ___:1
- [ ] Portfolio overlay text (dark mode): ___:1

#### Tools for Testing
```bash
# Install contrast checker
npm install -g a11y-contrast

# Check specific colors
a11y-contrast "#3b82f6" "#0f172a"
```

#### Success Criteria
- All hover states meet WCAG AA (4.5:1 minimum)
- Visual feedback clear in both themes
- No accessibility warnings in Lighthouse
- Smooth transitions between states

---

### Task 1.4: Add Hero Section Overlay
**Priority**: Critical
**Duration**: 2.5 hours
**Issue**: Hero text needs better contrast against background image

#### Files to Modify
1. `_config.yml`
2. `_sass/layout/_header.scss`
3. `_includes/header.html`

#### Implementation Steps

**Step 1**: Add config options
```yaml
# _config.yml

hero:
  heading: IT Leadership Portfolio
  description: Skilled IT leader with 12+ years...
  button_text: View My Work
  button_link: "#portfolio"
  background_image: img/header.jpg

  # NEW: Overlay configuration
  overlay_enabled: true
  overlay_color: "primary"    # primary, secondary, dark, custom
  overlay_opacity: 40         # 0-100 (percentage)
  overlay_blend_mode: "normal" # normal, multiply, overlay, screen
```

**Step 2**: Update header HTML
```html
<!-- _includes/header.html -->
<header
  style="background-image: url('{{ site.hero.background_image | relative_url }}');"
  {% if site.hero.overlay_enabled %}
  data-overlay="true"
  data-overlay-color="{{ site.hero.overlay_color }}"
  data-overlay-opacity="{{ site.hero.overlay_opacity }}"
  {% endif %}
>
  {% if site.hero.overlay_enabled %}
  <div class="header-overlay"
       style="--overlay-opacity: {{ site.hero.overlay_opacity | divided_by: 100.0 }};">
  </div>
  {% endif %}

  <div class="header-content">
    <div class="header-content-inner">
      <h1 id="homeHeading">{{ site.hero.heading }}</h1>
      <hr>
      <p>{{ site.hero.description }}</p>
      <a href="{{ site.hero.button_link }}" class="btn btn-primary btn-xl page-scroll">
        {{ site.hero.button_text }}
      </a>
    </div>
  </div>
</header>
```

**Step 3**: Update header SCSS
```scss
// _sass/layout/_header.scss

header {
  position: relative;
  min-height: 100vh;
  background-position: center;
  background-size: cover;
  background-repeat: no-repeat;
  text-align: center;
  color: var(--color-text-inverse);

  // Overlay layer
  .header-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1;
    opacity: var(--overlay-opacity, 0.4);
    transition: opacity var(--transition-normal);
  }

  // Overlay color variants
  &[data-overlay-color="primary"] .header-overlay {
    background: var(--color-primary);
    mix-blend-mode: multiply;
  }

  &[data-overlay-color="secondary"] .header-overlay {
    background: var(--color-secondary);
    mix-blend-mode: multiply;
  }

  &[data-overlay-color="dark"] .header-overlay {
    background: var(--color-neutral-900);
    mix-blend-mode: normal;
  }

  &[data-overlay-color="custom"] .header-overlay {
    background: linear-gradient(
      135deg,
      color-mix(in srgb, var(--color-primary) 80%, transparent),
      color-mix(in srgb, var(--color-secondary) 80%, transparent)
    );
    mix-blend-mode: multiply;
  }

  // Content layer (above overlay)
  .header-content {
    position: relative;
    z-index: 2;
    padding: var(--space-2xl) 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .header-content-inner {
    max-width: 900px;
    padding: 0 var(--space-md);

    h1 {
      font-size: clamp(2rem, 5vw, 4rem);
      font-weight: var(--font-weight-bold);
      text-transform: uppercase;
      margin-bottom: var(--space-lg);
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
    }

    hr {
      border-color: var(--color-text-inverse);
      max-width: 100px;
      margin: var(--space-lg) auto;
    }

    p {
      font-size: clamp(1rem, 2vw, 1.25rem);
      line-height: 1.6;
      margin-bottom: var(--space-xl);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
  }
}

// Dark mode adjustments
[data-theme="dark"] {
  header {
    &[data-overlay-color="dark"] .header-overlay {
      background: var(--color-neutral-800);
      opacity: 0.6;
    }
  }
}

// Responsive adjustments
@media (max-width: 768px) {
  header {
    .header-overlay {
      opacity: calc(var(--overlay-opacity, 0.4) + 0.1);  // Slightly stronger on mobile
    }
  }
}
```

**Step 4**: Add prefers-reduced-motion support
```scss
// Respect user's motion preferences
@media (prefers-reduced-motion: reduce) {
  header .header-overlay {
    transition: none;
  }
}
```

#### Testing Checklist
- [ ] Overlay renders correctly
- [ ] Config options work (color, opacity)
- [ ] Text contrast improved (measure with tools)
- [ ] Overlay doesn't block interactions
- [ ] Responsive on mobile (overlay stronger if needed)
- [ ] Works with all color palette choices
- [ ] Dark mode compatibility
- [ ] Overlay disabled when `overlay_enabled: false`

#### Success Criteria
- Hero text meets WCAG AAA (7:1 contrast ratio)
- Background image still visible
- User-configurable via _config.yml
- No performance impact

---

## Phase 1 Testing Strategy

### Manual Testing Checklist
- [ ] Test all fixes in Chrome (latest)
- [ ] Test all fixes in Firefox (latest)
- [ ] Test all fixes in Safari (latest)
- [ ] Test on mobile viewport (375px)
- [ ] Test on tablet viewport (768px)
- [ ] Test on desktop viewport (1920px)

### Automated Testing
```bash
# Build the site
bundle exec jekyll build

# Serve locally
bundle exec jekyll serve --livereload

# Run Lighthouse audit
lighthouse http://localhost:4000 --view

# Check contrast ratios
npm run test:contrast  # (if script exists)
```

### Visual Regression
1. Take screenshots before fixes
2. Take screenshots after fixes
3. Compare side-by-side
4. Document improvements

---

## Success Metrics

### Technical Metrics
- [ ] 0 console errors
- [ ] 0 console warnings
- [ ] WCAG AA compliance (all hover states)
- [ ] Lighthouse Accessibility: 95+

### User Experience Metrics
- [ ] Theme toggle always visible
- [ ] Logo consistent size
- [ ] Hover states clearly visible
- [ ] Hero text readable

---

## Rollback Plan

### If Issues Arise
1. **Git**: All changes in feature branch `feature/phase-1-critical-fixes`
2. **Backup**: Keep screenshots of original state
3. **Revert**: `git checkout main -- <file>` for individual files
4. **Full Rollback**: `git reset --hard HEAD^`

### Known Risks
- **Theme toggle**: May need JavaScript adjustments if CSS-only doesn't work
- **Hero overlay**: May need fine-tuning opacity based on background images
- **Contrast ratios**: May need color adjustments if WCAG not met

---

## Deliverables

### Code Deliverables
- [ ] Updated `_sass/layout/_navigation.scss`
- [ ] New `_sass/components/_theme-toggle.scss`
- [ ] Updated `_sass/components/_buttons.scss`
- [ ] Updated `_sass/base/_typography.scss`
- [ ] Updated `_sass/layout/_header.scss`
- [ ] Updated `_includes/design-tokens.html`
- [ ] Updated `_includes/header.html`
- [ ] Updated `_config.yml`

### Documentation Deliverables
- [ ] Update CLAUDE.md with new hero config options
- [ ] Document contrast ratios achieved
- [ ] Screenshot comparisons (before/after)

---

## Sign-Off

### Completed Tasks
- [ ] Task 1.1: Theme toggle visibility
- [ ] Task 1.2: Logo shrinking
- [ ] Task 1.3: Dark mode contrast
- [ ] Task 1.4: Hero overlay

### Phase 1 Complete
- [ ] All critical issues resolved
- [ ] All tests passing
- [ ] Documentation updated
- [ ] Ready for Phase 2

**Completed By**: _____________
**Date**: _____________
**Review Notes**: _____________

---

**Document Status**: âœ… Ready for Implementation
**Last Updated**: October 1, 2025
**Next Phase**: 03-20251001-001.02-phase-2-token-completion.md
