// =============================================================================
// Portfolio Box Component (BEM Structure)
// =============================================================================
// Image gallery component with hover overlay and flip functionality
// Merged from _portfolio-box.scss and _portfolio-flip.scss
// Following BEM naming convention and October 2025 best practices
// Migrated to BEM in Phase 4
// =============================================================================

@use '../abstracts' as *;

// -----------------------------------------------------------------------------
// Portfolio Box Container
// -----------------------------------------------------------------------------
// Wrapper for portfolio image with hover overlay effect
// Base styling for all portfolio boxes (flip and non-flip)
// -----------------------------------------------------------------------------
.portfolio-box {
    position: relative;
    display: block;
    max-width: 650px;
    margin: 0 auto;

    // Hover effect reveals caption overlay
    &:hover {
        .portfolio-box__overlay {
            opacity: var(--opacity-100);
        }
    }

    // -----------------------------------------------------------------------------
    // Flippable Modifier
    // -----------------------------------------------------------------------------
    // 3D flip animation for portfolio items on click
    // Shows detailed description on back side
    // -----------------------------------------------------------------------------
    &--flippable {
        perspective: 1000px;
        cursor: pointer;

        // Click indicator - animated corner brackets
        &::before,
        &::after {
            content: '';
            position: absolute;
            width: 30px;
            height: 30px;
            border: 3px solid var(--color-text-inverse);
            opacity: var(--opacity-0);
            transition: all var(--transition-normal);
            z-index: 10;
            pointer-events: none;
        }

        // Top-left corner bracket
        &::before {
            top: 10px;
            left: 10px;
            border-right: none;
            border-bottom: none;
        }

        // Bottom-right corner bracket
        &::after {
            bottom: 10px;
            right: 10px;
            border-left: none;
            border-top: none;
        }

        // Hover state - show corner brackets with pulse animation
        &:hover::before,
        &:hover::after {
            opacity: var(--opacity-100);
        }

        &:hover::before {
            animation: pulse-corner var(--duration-extra-slow) var(--ease-in-out) infinite;
        }

        &:hover::after {
            animation: pulse-corner var(--duration-extra-slow) var(--ease-in-out) infinite var(--delay-7);
        }
    }

    // -----------------------------------------------------------------------------
    // Flipped State Modifier
    // -----------------------------------------------------------------------------
    // Applied via JavaScript when portfolio item is clicked
    // -----------------------------------------------------------------------------
    &--flipped &__inner {
        transform: rotateY(180deg);
    }

    // -----------------------------------------------------------------------------
    // Portfolio Box Inner Container
    // -----------------------------------------------------------------------------
    // 3D transform container for flip animation
    // Only used in flippable variant
    // -----------------------------------------------------------------------------
    &__inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform var(--transition-slow);
        transform-style: preserve-3d;
    }

    // -----------------------------------------------------------------------------
    // Front and Back Faces
    // -----------------------------------------------------------------------------
    // Front: image with hover overlay
    // Back: detailed description with primary background
    // -----------------------------------------------------------------------------
    &__front,
    &__back {
        position: relative;
        width: 100%;
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
    }

    &__back {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        transform: rotateY(180deg);
        background: var(--color-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: var(--space-lg);
    }

    // -----------------------------------------------------------------------------
    // Portfolio Image
    // -----------------------------------------------------------------------------
    &__image {
        display: block;
        width: 100%;
        height: auto;
    }

    // -----------------------------------------------------------------------------
    // Portfolio Overlay
    // -----------------------------------------------------------------------------
    // Full-size overlay with primary color background
    // Hidden by default, revealed on hover
    // -----------------------------------------------------------------------------
    &__overlay {
        color: var(--color-text-inverse);
        opacity: var(--opacity-0);
        display: block;
        background: var(--color-primary);
        background: color-mix(in srgb, var(--color-primary) 90%, transparent);
        position: absolute;
        bottom: 0;
        text-align: center;
        width: 100%;
        height: 100%;
        transition: all var(--transition-normal);

        // Click indicator text (only in flippable variant)
        .portfolio-box--flippable &::after {
            content: 'ðŸ‘† Click to flip';
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.875rem;
            font-weight: var(--font-weight-semibold);
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(0, 0, 0, 0.3);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            animation: bounce-indicator var(--duration-2s) var(--ease-in-out) infinite;
        }
    }

    // -----------------------------------------------------------------------------
    // Portfolio Content
    // -----------------------------------------------------------------------------
    // Centered content wrapper for category and name
    // Used on both front overlay and back side
    // -----------------------------------------------------------------------------
    &__content {
        width: 100%;
        text-align: center;

        // Front side content (centered vertically in overlay)
        .portfolio-box__overlay & {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
        }

        // Back side content (already centered by flex)
        .portfolio-box__back & {
            // Additional spacing if needed
        }
    }

    // -----------------------------------------------------------------------------
    // Portfolio Category
    // -----------------------------------------------------------------------------
    &__category {
        font-family: var(--font-sans);
        text-transform: uppercase;
        font-weight: var(--font-weight-semibold);
        font-size: 0.875rem;
        padding: 0 var(--space-md);
        margin-bottom: var(--space-xs);
        opacity: var(--opacity-90);

        @media (min-width: 768px) {
            font-size: 1rem;
        }
    }

    // -----------------------------------------------------------------------------
    // Portfolio Name
    // -----------------------------------------------------------------------------
    &__name {
        font-family: var(--font-sans);
        font-size: 1.125rem;
        font-weight: var(--font-weight-bold);
        padding: 0 var(--space-md);

        // More spacing on back side
        .portfolio-box__back & {
            margin-bottom: var(--space-md);
        }

        @media (min-width: 768px) {
            font-size: 1.375rem;
        }
    }

    // -----------------------------------------------------------------------------
    // Portfolio Description
    // -----------------------------------------------------------------------------
    // Only shown on back side of flippable portfolios
    // -----------------------------------------------------------------------------
    &__description {
        font-size: var(--font-size-md);
        line-height: var(--line-height-base);
        margin: 0;
        padding: 0 var(--space-md);

        @media (min-width: 768px) {
            font-size: var(--font-size-base);
        }
    }
}

// -----------------------------------------------------------------------------
// Animations
// -----------------------------------------------------------------------------
// Pulse animation for corner brackets
@keyframes pulse-corner {
    0%, 100% {
        transform: scale(1);
        opacity: var(--opacity-100);
    }
    50% {
        transform: scale(1.1);
        opacity: var(--opacity-70);
    }
}

// Bounce animation for click indicator text
@keyframes bounce-indicator {
    0%, 100% {
        transform: translateX(-50%) translateY(0);
    }
    50% {
        transform: translateX(-50%) translateY(-5px);
    }
}
