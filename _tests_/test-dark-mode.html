<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Mode Text Visibility Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        /* Inline theme initialization for testing */
        :root { --color-primary-400: #ff6b4a; }
        body { padding: 0; margin: 0; }
        .test-section { padding: 50px 20px; }
        .controls { position: fixed; top: 20px; right: 20px; z-index: 1000; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        [data-theme="dark"] .controls { background: #333; color: white; }
    </style>
</head>
<body>
    <div class="controls">
        <h5>Theme Control</h5>
        <button onclick="setTheme('light')" class="btn btn-sm btn-light">Light</button>
        <button onclick="setTheme('dark')" class="btn btn-sm btn-dark">Dark</button>
        <hr>
        <small>Current: <span id="current-theme">light</span></small>
    </div>

    <!-- Test Core Competencies Section (Services) -->
    <section id="services" class="test-section">
        <div class="container">
            <h2 class="text-center mb-5">Core Competencies (No Background)</h2>
            <div class="row">
                <div class="col-md-6">
                    <h4>Normal Text</h4>
                    <p>This is regular paragraph text without any class applied.</p>
                </div>
                <div class="col-md-6">
                    <h4>Text-Muted Class</h4>
                    <p class="text-muted">This text uses the .text-muted class - it should be readable in both themes.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Test with Primary Background -->
    <section class="bg-primary test-section text-white">
        <div class="container">
            <h2 class="text-center mb-5">Core Competencies (Primary Background)</h2>
            <div class="row">
                <div class="col-md-6">
                    <h4>Normal Text</h4>
                    <p>This is regular paragraph text on primary background.</p>
                </div>
                <div class="col-md-6">
                    <h4>Text-Muted Class</h4>
                    <p class="text-muted">This text uses .text-muted on primary background - should be white/readable in dark mode.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Test with Secondary Background -->
    <section class="bg-secondary test-section text-white">
        <div class="container">
            <h2 class="text-center mb-5">Core Competencies (Secondary Background)</h2>
            <div class="row">
                <div class="col-md-6">
                    <h4>Normal Text</h4>
                    <p>This is regular paragraph text on secondary background.</p>
                </div>
                <div class="col-md-6">
                    <h4>Text-Muted Class</h4>
                    <p class="text-muted">This text uses .text-muted on secondary background - should be white/readable in dark mode.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Comparison Section -->
    <section class="test-section">
        <div class="container">
            <h2 class="text-center mb-5">Text Class Comparison</h2>
            <div class="row">
                <div class="col-md-4">
                    <h4>text-muted</h4>
                    <p class="text-muted">Uses var(--color-text-muted)</p>
                </div>
                <div class="col-md-4">
                    <h4>text-faded</h4>
                    <p class="text-faded">Uses var(--color-text-faded)</p>
                </div>
                <div class="col-md-4">
                    <h4>No class</h4>
                    <p>Uses default text color</p>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Theme toggle functionality
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            document.getElementById('current-theme').textContent = theme;
            localStorage.setItem('theme', theme);
        }

        // Initialize theme from localStorage
        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme);

        // Load design tokens
        fetch('/').then(r => r.text()).then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const styleTag = doc.querySelector('style');
            if (styleTag && styleTag.textContent.includes(':root')) {
                document.head.appendChild(styleTag.cloneNode(true));
            }
        });
    </script>
</body>
</html>